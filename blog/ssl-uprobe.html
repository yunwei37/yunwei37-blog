<!DOCTYPE html><!--MYXrWUjg0HELsl6zLYF_6--><html lang="en-us" class="__variable_dd5b2f scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/36966cca54120369-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/4ac7c0f872b74ee7.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/a06d7e24bf9a7d93.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/7246298b30c42979.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-91cf1b3b084c6ba2.js"/><script src="/_next/static/chunks/4bd1b696-cf72ae8a39fa05aa.js" async=""></script><script src="/_next/static/chunks/964-dd2321b4b492b566.js" async=""></script><script src="/_next/static/chunks/main-app-01d32ba99375ba1b.js" async=""></script><script src="/_next/static/chunks/874-8edb22cc7428423c.js" async=""></script><script src="/_next/static/chunks/650-5bb235cd9bfca45d.js" async=""></script><script src="/_next/static/chunks/app/layout-66df3ac28fcfbced.js" async=""></script><script src="/_next/static/chunks/63-d245e42a784ca56d.js" async=""></script><script src="/_next/static/chunks/app/blog/%5B...slug%5D/page-1ed2702378ba9d6b.js" async=""></script><link rel="preload" href="https://analytics.umami.is/script.js" as="script"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/svg+xml" href="/static/favicons/favicon.svg"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="next-size-adjust" content=""/><title>eBPF Practical Tutorial: Capturing SSL/TLS Plain Text Data Using uprobe | 云微的胡思乱想</title><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><link rel="canonical" href="https://www.yunwei37.com/blog/ssl-uprobe"/><link rel="alternate" type="application/rss+xml" href="https://www.yunwei37.com/feed.xml"/><meta property="og:title" content="eBPF Practical Tutorial: Capturing SSL/TLS Plain Text Data Using uprobe"/><meta property="og:url" content="https://www.yunwei37.com/blog/ssl-uprobe"/><meta property="og:site_name" content="云微的胡思乱想"/><meta property="og:locale" content="en_US"/><meta property="og:image" content="https://www.yunwei37.com/static/images/twitter-card.png"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2023-06-14T02:41:06.000Z"/><meta property="article:modified_time" content="2023-06-14T02:41:06.000Z"/><meta property="article:author" content="Yusheng Zheng (云微)"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="eBPF Practical Tutorial: Capturing SSL/TLS Plain Text Data Using uprobe"/><meta name="twitter:image" content="https://www.yunwei37.com/static/images/twitter-card.png"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="pl-[calc(100vw-100%)] text-black antialiased dark:text-white min-h-screen"><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="min-h-screen flex flex-col justify-center py-8"><div class="content-glass mx-auto w-full max-w-5xl px-4 sm:px-6 xl:px-8 py-8"><header class="flex items-center w-full justify-between py-6 border-b border-gray-200/30 dark:border-gray-700/30"><a class="break-words" aria-label="yunwei37" href="/"><div class="flex items-center"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="none"><defs><linearGradient id="logo_svg__a" x1="0%" x2="100%" y1="0%" y2="100%"><stop offset="0%" style="stop-color:#3b82f6;stop-opacity:1"></stop><stop offset="100%" style="stop-color:#06b6d4;stop-opacity:1"></stop></linearGradient><linearGradient id="logo_svg__b" x1="0%" x2="100%" y1="0%" y2="100%"><stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1"></stop><stop offset="100%" style="stop-color:#3b82f6;stop-opacity:1"></stop></linearGradient></defs><circle cx="20" cy="20" r="18" fill="url(#logo_svg__a)" opacity="0.1"></circle><path fill="url(#logo_svg__a)" d="m12 8 6 10v10h4V18l6-10h-4l-4 6-4-6Z"></path><path fill="url(#logo_svg__b)" d="m8 24 4 8 4-8 4 8 4-8h8v4h-6l-4 8-4-8-4 8-4-8H8Z" opacity="0.8"></path><circle cx="32" cy="12" r="2" fill="url(#logo_svg__b)"></circle><circle cx="8" cy="12" r="1.5" fill="url(#logo_svg__a)" opacity="0.6"></circle></svg></div><div class="hidden text-2xl font-bold sm:block hover:text-primary-600 dark:hover:text-primary-400 transition-colors">yunwei37</div></div></a><div class="flex items-center space-x-4"><div class="no-scrollbar hidden items-center space-x-2 sm:flex"><a class="px-3 py-2 rounded-lg transition-all duration-200 font-medium hover:text-primary-600 dark:hover:text-primary-400" href="/blog">Blog</a><a class="px-3 py-2 rounded-lg transition-all duration-200 font-medium hover:text-primary-600 dark:hover:text-primary-400" href="/docs">Docs</a><a class="px-3 py-2 rounded-lg transition-all duration-200 font-medium hover:text-primary-600 dark:hover:text-primary-400" href="/tags">Tags</a><a class="px-3 py-2 rounded-lg transition-all duration-200 font-medium hover:text-primary-600 dark:hover:text-primary-400" href="/about">About</a></div><div class="flex items-center space-x-2"><button aria-label="Search" class="p-2 rounded-lg transition-all duration-200"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-6 w-6 hover:text-primary-600 dark:hover:text-primary-400 transition-colors"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></button><button aria-label="Toggle Menu" class="sm:hidden p-2 rounded-lg hover:glass transition-all duration-200 hover:scale-105"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-6 w-6 hover:text-primary-600 dark:hover:text-primary-400 transition-colors"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><span hidden="" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0;display:none"></span></div></div></header><main class="py-6"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"eBPF Practical Tutorial: Capturing SSL/TLS Plain Text Data Using uprobe","datePublished":"2023-06-14T02:41:06.000Z","dateModified":"2023-06-14T02:41:06.000Z","image":"/static/images/twitter-card.png","url":"https://www.yunwei37.com/blog/ssl-uprobe","author":[{"@type":"Person","name":"Yusheng Zheng (云微)"}]}</script><section class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" class="rounded-full bg-white/20 dark:bg-black/20 p-2 transition-all hover:bg-white/30 dark:hover:bg-black/30"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" class="rounded-full bg-white/20 dark:bg-black/20 p-2 transition-all hover:bg-white/30 dark:hover:bg-black/30"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article class="content-glass p-8"><div class="xl:divide-y xl:divide-gray-200/30 xl:dark:divide-gray-700/30"><header class="pt-6 xl:pb-6"><div class="space-y-4 text-center"><dl class="space-y-4"><div><dt class="sr-only">Published on</dt><dd class="text-base leading-6 font-medium text-gray-600 dark:text-gray-300"><time dateTime="2023-06-14T02:41:06.000Z">Wednesday, June 14, 2023</time></dd></div></dl><div><h1 class="text-3xl leading-9 font-extrabold tracking-tight sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">eBPF Practical Tutorial: Capturing SSL/TLS Plain Text Data Using uprobe</h1></div></div></header><div class="grid-rows-[auto_1fr] divide-y divide-gray-200/30 pb-8 xl:grid xl:grid-cols-4 xl:gap-x-8 xl:divide-y-0 dark:divide-gray-700/30"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200/30 xl:pt-11 xl:dark:border-gray-700/30"><dt class="sr-only">Authors</dt><dd><ul class="flex flex-wrap justify-center gap-4 sm:space-x-12 xl:block xl:space-y-6 xl:space-x-0"><li class="flex items-center space-x-3 glass p-4 rounded-xl"><img alt="avatar" loading="lazy" width="38" height="38" decoding="async" data-nimg="1" class="h-10 w-10 rounded-full" style="color:transparent" src="/static/images/avatar.png"/><dl class="text-sm leading-5 font-medium whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Yusheng Zheng (云微)</dd><dt class="sr-only">Twitter</dt><dd><a class="text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 transition-colors" target="_blank" rel="noopener noreferrer" href="https://twitter.com/yunwei37">@yunwei37</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200/30 xl:col-span-3 xl:row-span-2 xl:pb-0 dark:divide-gray-700/30"><div class="prose dark:prose-invert max-w-none pt-10 pb-8 text-gray-700 dark:text-gray-200"><p>With the widespread use of TLS in modern network environments, tracing microservices RPC messages has become increasingly challenging. Traditional traffic sniffing techniques often face limitations in accessing only encrypted data, preventing a genuine observation of the original communication content. This restriction poses significant obstacles to system debugging and analysis.</p><p>However, a new solution is now available. Through the use of eBPF technology and its capability to perform probing in user space, a method has emerged to regain plain text data, allowing us to intuitively view the pre-encrypted communication content. Nevertheless, each application might utilize different libraries, and each library comes in multiple versions, introducing complexity to the tracking process.</p><p>In this tutorial, we will guide you through an eBPF tracing technique that spans across various user-space SSL/TLS libraries. This technique not only allows simultaneous tracing of user-space libraries like GnuTLS and OpenSSL but also significantly reduces maintenance efforts for new library versions compared to previous methods.</p><h2 class="content-header" id="background-knowledge"><a class="break-words" href="#background-knowledge" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Background Knowledge</h2><p>Before delving into the main topic of this tutorial, we need to grasp some core concepts that will serve as the foundation for our subsequent discussions.</p><h3 class="content-header" id="ssl-and-tls"><a class="break-words" href="#ssl-and-tls" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>SSL and TLS</h3><p>SSL (Secure Sockets Layer): Developed by Netscape in the early 1990s, SSL provides data encryption for communication between two machines on a network. However, due to known security vulnerabilities, SSL has been succeeded by its successor, TLS.</p><p>TLS (Transport Layer Security): TLS is the successor to SSL, aiming to provide stronger and more secure data encryption methods. TLS operates through a handshake process during which a client and a server select an encryption algorithm and corresponding keys. Once the handshake is complete, data transmission begins, with all data being encrypted using the chosen algorithm and keys.</p><h3 class="content-header" id="operation-principles-of-tls"><a class="break-words" href="#operation-principles-of-tls" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Operation Principles of TLS</h3><p>Transport Layer Security (TLS) is a cryptographic protocol designed to provide security for communication over computer networks. Its primary goal is to provide security, including privacy (confidentiality), integrity, and authenticity, for two or more communicating computer applications over a network using cryptography, such as certificates. TLS consists of two sub-layers: the TLS Record Protocol and the TLS Handshake Protocol.</p><h4 class="content-header" id="handshake-process"><a class="break-words" href="#handshake-process" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Handshake Process</h4><p>When a client connects to a TLS-enabled server and requests a secure connection, the handshake process begins. The handshake allows the client and server to establish security parameters for the connection using asymmetric cryptography. The complete process is as follows:</p><ol><li><strong>Initial Handshake</strong>: The client connects to the TLS-enabled server, requests a secure connection, and provides a list of supported cipher suites (encryption algorithms and hash functions).</li><li><strong>Selecting Cipher Suite</strong>: From the provided list, the server chooses a cipher suite and hash function it also supports and notifies the client of the decision.</li><li><strong>Providing Digital Certificate</strong>: Usually, the server then provides identity authentication in the form of a digital certificate. This certificate includes the server&#x27;s name, trusted certificate authorities (guaranteeing the certificate&#x27;s authenticity), and the server&#x27;s public encryption key.</li><li><strong>Certificate Verification</strong>: The client verifies the certificate&#x27;s validity before proceeding.</li><li><strong>Generating Session Key</strong>: To create a session key for a secure connection, the client has two methods:<ul><li>Encrypt a random number (PreMasterSecret) with the server&#x27;s public key and send the result to the server (only the server can decrypt it with its private key); both parties then use this random number to generate a unique session key for encrypting and decrypting data during the session.</li><li>Use Diffie-Hellman key exchange (or its variant, Elliptic Curve DH) to securely generate a random and unique session key for encryption and decryption. This key has the additional property of forward secrecy: even if the server&#x27;s private key is exposed in the future, it can&#x27;t be used to decrypt the current session, even if a third party intercepts and records the session.</li></ul></li></ol><p>Once these steps are successfully completed, the handshake process concludes, and the encrypted connection begins. This connection uses the session key for encryption and decryption until the connection is closed. If any of the above steps fail, the TLS handshake fails, and the connection won&#x27;t be established.</p><h4 class="content-header" id="tls-in-the-osi-model"><a class="break-words" href="#tls-in-the-osi-model" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>TLS in the OSI Model</h4><p>TLS and SSL don&#x27;t perfectly align with any single layer of the OSI model or the TCP/IP model. TLS &quot;runs over some reliable transport protocol (such as TCP),&quot; which means it sits above the transport layer. It provides encryption for higher layers, typically the presentation layer. However, applications using TLS often consider it the transport layer, even though applications using TLS must actively control the initiation of TLS handshakes and the handling of exchanged authentication certificates.</p><h3 class="content-header" id="ebpf-and-uprobes"><a class="break-words" href="#ebpf-and-uprobes" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>eBPF and uprobes</h3><p>eBPF (Extended Berkeley Packet Filter): It&#x27;s a kernel technology that allows users to run predefined programs in the kernel space without modifying kernel source code or reloading modules. It creates a bridge that enables interaction between user space and kernel space, providing unprecedented capabilities for tasks like system monitoring, performance analysis, and network traffic analysis.</p><p>uprobes are a significant feature of eBPF, allowing dynamic insertion of probe points in user space applications, particularly useful for tracking function calls in SSL/TLS libraries.</p><h3 class="content-header" id="user-space-libraries"><a class="break-words" href="#user-space-libraries" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>User-Space Libraries</h3><p>The implementation of the SSL/TLS protocol heavily relies on user-space libraries. Here are some common ones:</p><ul><li>OpenSSL: An open-source, feature-rich cryptographic library widely used in many open-source and commercial projects.</li><li>BoringSSL: A fork of OpenSSL maintained by Google, focusing on simplification and optimization for Google&#x27;s needs.</li><li>GnuTLS: Part of the GNU project, offering an implementation of SSL, TLS, and DTLS protocols. GnuTLS differs from OpenSSL and BoringSSL in API design, module structure, and licensing.</li></ul><h2 class="content-header" id="openssl-api-analysis"><a class="break-words" href="#openssl-api-analysis" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>OpenSSL API Analysis</h2><p>OpenSSL is a widely used open-source library providing a complete implementation of the SSL and TLS protocols, ensuring data transmission security in various applications. Among its functions, SSL_read() and SSL_write() are two core API functions for reading from and writing to TLS/SSL connections. In this section, we&#x27;ll delve into these functions to help you understand their mechanisms.</p><h3 class="content-header" id="1-ssl_read-function"><a class="break-words" href="#1-ssl_read-function" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>1. SSL_read Function</h3><p>When we want to read data from an established SSL connection, we can use the <code>SSL_read</code> or <code>SSL_read_ex</code> function. The function prototype is as follows:</p><div class="relative"><pre><code class="language-c code-highlight"><span class="code-line"><span class="token keyword">int</span> <span class="token function">SSL_read_ex</span><span class="token punctuation">(</span>SSL <span class="token operator">*</span>ssl<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> <span class="token class-name">size_t</span> num<span class="token punctuation">,</span> <span class="token class-name">size_t</span> <span class="token operator">*</span>readbytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">SSL_read</span><span class="token punctuation">(</span>SSL <span class="token operator">*</span>ssl<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><p><code>SSL_read</code> and <code>SSL_read_ex</code> attempt to read up to <code>num</code> bytes of data from the specified <code>ssl</code> into the buffer <code>buf</code>. Upon success, <code>SSL_read_ex</code> stores the actual number of read bytes in <code>*readbytes</code>.</p><h3 class="content-header" id="2-function-ssl_write"><a class="break-words" href="#2-function-ssl_write" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>2. Function SSL_write</h3><p>When we want to write data into an established SSL connection, we can use the <code>SSL_write</code> or <code>SSL_write_ex</code> functions.</p><p>Function prototype:</p><div class="relative"><pre><code class="language-c code-highlight"><span class="code-line"><span class="token keyword">int</span> <span class="token function">SSL_write_ex</span><span class="token punctuation">(</span>SSL <span class="token operator">*</span>s<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> <span class="token class-name">size_t</span> num<span class="token punctuation">,</span> <span class="token class-name">size_t</span> <span class="token operator">*</span>written<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">SSL_write</span><span class="token punctuation">(</span>SSL <span class="token operator">*</span>ssl<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><p><code>SSL_write</code> and <code>SSL_write_ex</code> will write up to <code>num</code> bytes of data from the buffer <code>buf</code> into the specified <code>ssl</code> connection. Upon success, <code>SSL_write_ex</code> will store the actual number of written bytes in <code>*written</code>.</p><h2 class="content-header" id="writing-ebpf-kernel-code"><a class="break-words" href="#writing-ebpf-kernel-code" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Writing eBPF Kernel Code</h2><p>In our example, we use eBPF to hook the <code>ssl_read</code> and <code>ssl_write</code> functions to perform custom actions when data is read from or written to an SSL connection.</p><h3 class="content-header" id="data-structures"><a class="break-words" href="#data-structures" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Data Structures</h3><p>Firstly, we define a data structure <code>probe_SSL_data_t</code> to transfer data between kernel and user space:</p><div class="relative"><pre><code class="language-c code-highlight"><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">define</span> <span class="token macro-name">MAX_BUF_SIZE</span> <span class="token expression"><span class="token number">8192</span></span></span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">define</span> <span class="token macro-name">TASK_COMM_LEN</span> <span class="token expression"><span class="token number">16</span></span></span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">struct</span> <span class="token class-name">probe_SSL_data_t</span> <span class="token punctuation">{</span>
</span><span class="code-line">    __u64 timestamp_ns<span class="token punctuation">;</span>  <span class="token comment">// Timestamp (nanoseconds)</span>
</span><span class="code-line">    __u64 delta_ns<span class="token punctuation">;</span>      <span class="token comment">// Function execution time</span>
</span><span class="code-line">    __u32 pid<span class="token punctuation">;</span>           <span class="token comment">// Process ID</span>
</span><span class="code-line">    __u32 tid<span class="token punctuation">;</span>           <span class="token comment">// Thread ID</span>
</span><span class="code-line">    __u32 uid<span class="token punctuation">;</span>           <span class="token comment">// User ID</span>
</span><span class="code-line">    __u32 len<span class="token punctuation">;</span>           <span class="token comment">// Length of read/write data</span>
</span><span class="code-line">    <span class="token keyword">int</span> buf_filled<span class="token punctuation">;</span>      <span class="token comment">// Whether buffer is filled completely</span>
</span><span class="code-line">    <span class="token keyword">int</span> rw<span class="token punctuation">;</span>              <span class="token comment">// Read or Write (0 for read, 1 for write)</span>
</span><span class="code-line">    <span class="token keyword">char</span> comm<span class="token punctuation">[</span>TASK_COMM_LEN<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Process name</span>
</span><span class="code-line">    __u8 buf<span class="token punctuation">[</span>MAX_BUF_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// Data buffer</span>
</span><span class="code-line">    <span class="token keyword">int</span> is_handshake<span class="token punctuation">;</span>    <span class="token comment">// Whether it&#x27;s handshake data</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre></div><h3 class="content-header" id="hook-functions"><a class="break-words" href="#hook-functions" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Hook Functions</h3><p>Our goal is to hook into the <code>SSL_read</code> and <code>SSL_write</code> functions. We define a function <code>SSL_exit</code> to handle the return values of these two functions. This function determines whether to trace and collect data based on the current process and thread IDs.</p><div class="relative"><pre><code class="language-c code-highlight"><span class="code-line"><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">SSL_exit</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">pt_regs</span> <span class="token operator">*</span>ctx<span class="token punctuation">,</span> <span class="token keyword">int</span> rw<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">    u32 zero <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">    u64 pid_tgid <span class="token operator">=</span> <span class="token function">bpf_get_current_pid_tgid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    u32 pid <span class="token operator">=</span> pid_tgid <span class="token operator">&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">;</span>
</span><span class="code-line">    u32 tid <span class="token operator">=</span> <span class="token punctuation">(</span>u32<span class="token punctuation">)</span>pid_tgid<span class="token punctuation">;</span>
</span><span class="code-line">    u32 uid <span class="token operator">=</span> <span class="token function">bpf_get_current_uid_gid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    u64 ts <span class="token operator">=</span> <span class="token function">bpf_ktime_get_ns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">trace_allowed</span><span class="token punctuation">(</span>uid<span class="token punctuation">,</span> pid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">/* store arg info for later lookup */</span>
</span><span class="code-line">    u64 <span class="token operator">*</span>bufp <span class="token operator">=</span> <span class="token function">bpf_map_lookup_elem</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>bufs<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tid<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>bufp <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    u64 <span class="token operator">*</span>tsp <span class="token operator">=</span> <span class="token function">bpf_map_lookup_elem</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>start_ns<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tid<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tsp<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">    u64 delta_ns <span class="token operator">=</span> ts <span class="token operator">-</span> <span class="token operator">*</span>tsp<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">PT_REGS_RC</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">// no data</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">struct</span> <span class="token class-name">probe_SSL_data_t</span> <span class="token operator">*</span>data <span class="token operator">=</span> <span class="token function">bpf_map_lookup_elem</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ssl_data<span class="token punctuation">,</span> <span class="token operator">&amp;</span>zero<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    data<span class="token operator">-&gt;</span>timestamp_ns <span class="token operator">=</span> ts<span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>delta_ns <span class="token operator">=</span> delta_ns<span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>pid <span class="token operator">=</span> pid<span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>tid <span class="token operator">=</span> tid<span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>uid <span class="token operator">=</span> uid<span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>len <span class="token operator">=</span> <span class="token punctuation">(</span>u32<span class="token punctuation">)</span>len<span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>buf_filled <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>rw <span class="token operator">=</span> rw<span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>is_handshake <span class="token operator">=</span> false<span class="token punctuation">;</span>
</span><span class="code-line">    u32 buf_copy_size <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">size_t</span><span class="token punctuation">)</span>MAX_BUF_SIZE<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span><span class="token punctuation">)</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token function">bpf_get_current_comm</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>data<span class="token operator">-&gt;</span>comm<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>data<span class="token operator">-&gt;</span>comm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>bufp <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">        ret <span class="token operator">=</span> <span class="token function">bpf_probe_read_user</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>data<span class="token operator">-&gt;</span>buf<span class="token punctuation">,</span> buf_copy_size<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">*</span>bufp<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token function">bpf_map_delete_elem</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>bufs<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tid<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">bpf_map_delete_elem</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>start_ns<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tid<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ret<span class="token punctuation">)</span>
</span><span class="code-line">        data<span class="token operator">-&gt;</span>buf_filled <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">else</span>
</span><span class="code-line">        buf_copy_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token function">bpf_perf_event_output</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>perf_SSL_events<span class="token punctuation">,</span> BPF_F_CURRENT_CPU<span class="token punctuation">,</span> data<span class="token punctuation">,</span>
</span><span class="code-line">                            <span class="token function">EVENT_SIZE</span><span class="token punctuation">(</span>buf_copy_size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>The <code>rw</code> parameter here indicates whether it&#x27;s a read or write operation. 0 represents read, and 1 represents write.</p><h4 class="content-header" id="data-collection-process"><a class="break-words" href="#data-collection-process" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Data Collection Process</h4><ol><li>Obtain the ID of the current process and thread, along with the ID of the current user.</li><li>Use <code>trace_allowed</code> to determine if tracing is allowed for this process.</li><li>Get the start time to calculate the execution time of the function.</li><li>Attempt to retrieve relevant data from the <code>bufs</code> and <code>start_ns</code> maps.</li><li>If data retrieval is successful, create or locate a <code>probe_SSL_data_t</code> structure to populate the data.</li><li>Copy the data from user space to the buffer, ensuring it doesn&#x27;t exceed the designated size.</li><li>Finally, send the data to user space.</li></ol><p>Note: We use two user-level return probes <code>uretprobe</code> to respectively hook the returns of <code>SSL_read</code> and <code>SSL_write</code>:</p><div class="relative"><pre><code class="language-c code-highlight"><span class="code-line"><span class="token function">SEC</span><span class="token punctuation">(</span><span class="token string">&quot;uretprobe/SSL_read&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">BPF_URETPROBE</span><span class="token punctuation">(</span>probe_SSL_read_exit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">SSL_exit</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 0 indicates read operation</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token function">SEC</span><span class="token punctuation">(</span><span class="token string">&quot;uretprobe/SSL_write&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">BPF_URETPROBE</span><span class="token punctuation">(</span>probe_SSL_write_exit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">SSL_exit</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 1 indicates write operation</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h3 class="content-header" id="hooking-into-the-handshake-process"><a class="break-words" href="#hooking-into-the-handshake-process" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Hooking into the Handshake Process</h3><p>In SSL/TLS, the handshake is a special process used to establish a secure connection between a client and a server. To analyze this process, we hook into the <code>do_handshake</code> function to track the start and end of the handshake.</p><h4 class="content-header" id="entering-the-handshake"><a class="break-words" href="#entering-the-handshake" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Entering the Handshake</h4><p>We use a <code>uprobe</code> to set a probe for the <code>do_handshake</code> function:</p><div class="relative"><pre><code class="language-c code-highlight"><span class="code-line">
</span><span class="code-line"><span class="token function">SEC</span><span class="token punctuation">(</span><span class="token string">&quot;uprobe/do_handshake&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">BPF_UPROBE</span><span class="token punctuation">(</span>probe_SSL_do_handshake_enter<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>ssl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    u64 pid_tgid <span class="token operator">=</span> <span class="token function">bpf_get_current_pid_tgid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    u32 pid <span class="token operator">=</span> pid_tgid <span class="token operator">&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">;</span>
</span><span class="code-line">    u32 tid <span class="token operator">=</span> <span class="token punctuation">(</span>u32<span class="token punctuation">)</span>pid_tgid<span class="token punctuation">;</span>
</span><span class="code-line">    u64 ts <span class="token operator">=</span> <span class="token function">bpf_ktime_get_ns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    u32 uid <span class="token operator">=</span> <span class="token function">bpf_get_current_uid_gid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">trace_allowed</span><span class="token punctuation">(</span>uid<span class="token punctuation">,</span> pid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">/* store arg info for later lookup */</span>
</span><span class="code-line">    <span class="token function">bpf_map_update_elem</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>start_ns<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tid<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ts<span class="token punctuation">,</span> BPF_ANY<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>The main functionality of this code is as follows:</p><ol><li>Obtain the current <code>pid</code>, <code>tid</code>, <code>ts</code>, and <code>uid</code>.</li><li>Use <code>trace_allowed</code> to verify if the process is allowed to be traced.</li><li>Store the current timestamp in the <code>start_ns</code> map, which will be used to calculate the duration of the handshake process later.</li></ol><h4 class="content-header" id="exiting-the-handshake"><a class="break-words" href="#exiting-the-handshake" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Exiting the Handshake</h4><p>Similarly, we&#x27;ve set a <code>uretprobe</code> for the return of <code>do_handshake</code>:</p><div class="relative"><pre><code class="language-c code-highlight"><span class="code-line"><span class="token function">SEC</span><span class="token punctuation">(</span><span class="token string">&quot;uretprobe/do_handshake&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">BPF_URETPROBE</span><span class="token punctuation">(</span>handle_do_handshake_exit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token comment">// Code to execute upon exiting the do_handshake function.</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>In this context, the <code>uretprobe</code> will execute the provided code when the <code>do_handshake</code> function exits.</p><div class="relative"><pre><code class="language-c code-highlight"><span class="code-line">
</span><span class="code-line"><span class="token function">SEC</span><span class="token punctuation">(</span><span class="token string">&quot;uretprobe/do_handshake&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">BPF_URETPROBE</span><span class="token punctuation">(</span>probe_SSL_do_handshake_exit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    u32 zero <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">    u64 pid_tgid <span class="token operator">=</span> <span class="token function">bpf_get_current_pid_tgid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    u32 pid <span class="token operator">=</span> pid_tgid <span class="token operator">&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">;</span>
</span><span class="code-line">    u32 tid <span class="token operator">=</span> <span class="token punctuation">(</span>u32<span class="token punctuation">)</span>pid_tgid<span class="token punctuation">;</span>
</span><span class="code-line">    u32 uid <span class="token operator">=</span> <span class="token function">bpf_get_current_uid_gid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    u64 ts <span class="token operator">=</span> <span class="token function">bpf_ktime_get_ns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">/* use kernel terminology here for tgid/pid: */</span>
</span><span class="code-line">    u32 tgid <span class="token operator">=</span> pid_tgid <span class="token operator">&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">/* store arg info for later lookup */</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">trace_allowed</span><span class="token punctuation">(</span>tgid<span class="token punctuation">,</span> pid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    u64 <span class="token operator">*</span>tsp <span class="token operator">=</span> <span class="token function">bpf_map_lookup_elem</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>start_ns<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tid<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>tsp <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    ret <span class="token operator">=</span> <span class="token function">PT_REGS_RC</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">// handshake failed</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">struct</span> <span class="token class-name">probe_SSL_data_t</span> <span class="token operator">*</span>data <span class="token operator">=</span> <span class="token function">bpf_map_lookup_elem</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ssl_data<span class="token punctuation">,</span> <span class="token operator">&amp;</span>zero<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    data<span class="token operator">-&gt;</span>timestamp_ns <span class="token operator">=</span> ts<span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>delta_ns <span class="token operator">=</span> ts <span class="token operator">-</span> <span class="token operator">*</span>tsp<span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>pid <span class="token operator">=</span> pid<span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>tid <span class="token operator">=</span> tid<span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>uid <span class="token operator">=</span> uid<span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>len <span class="token operator">=</span> ret<span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>buf_filled <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>rw <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</span><span class="code-line">    data<span class="token operator">-&gt;</span>is_handshake <span class="token operator">=</span> true<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">bpf_get_current_comm</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>data<span class="token operator">-&gt;</span>comm<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>data<span class="token operator">-&gt;</span>comm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">bpf_map_delete_elem</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>start_ns<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tid<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token function">bpf_perf_event_output</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>perf_SSL_events<span class="token punctuation">,</span> BPF_F_CURRENT_CPU<span class="token punctuation">,</span> data<span class="token punctuation">,</span>
</span><span class="code-line">                            <span class="token function">EVENT_SIZE</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>Logic of this Function:</p><ol><li>Obtain the current <code>pid</code>, <code>tid</code>, <code>ts</code>, and <code>uid</code>.</li><li>Use <code>trace_allowed</code> to recheck if tracing is allowed.</li><li>Look up the timestamp in the <code>start_ns</code> map for calculating handshake duration.</li><li>Use <code>PT_REGS_RC(ctx)</code> to get the return value of <code>do_handshake</code> and determine if the handshake was successful.</li><li>Find or initialize the <code>probe_SSL_data_t</code> data structure associated with the current thread.</li><li>Update the data structure&#x27;s fields, including timestamp, duration, process information, etc.</li><li>Use <code>bpf_perf_event_output</code> to send the data to user space.</li></ol><p>Our eBPF code not only tracks data transmission for <code>ssl_read</code> and <code>ssl_write</code> but also focuses on the SSL/TLS handshake process. This information is crucial for a deeper understanding and optimization of the performance of secure connections.</p><p>Through these hook functions, we can obtain data regarding the success of the handshake, the time taken for the handshake, and related process information. This provides us with insights into the behavior of the system&#x27;s SSL/TLS, enabling us to perform more in-depth analysis and optimization when necessary.</p><h2 class="content-header" id="user-space-assisted-code-analysis-and-interpretation"><a class="break-words" href="#user-space-assisted-code-analysis-and-interpretation" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>User-Space Assisted Code Analysis and Interpretation</h2><p>In the eBPF ecosystem, user-space and kernel-space code often work in collaboration. Kernel-space code is responsible for data collection, while user-space code manages, processes, and handles this data. In this section, we will explain how the above user-space code collaborates with eBPF to trace SSL/TLS interactions.</p><h3 class="content-header" id="1-supported-library-attachment"><a class="break-words" href="#1-supported-library-attachment" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>1. Supported Library Attachment</h3><p>In the provided code snippet, based on the setting of the <code>env</code> environment variable, the program can choose to attach to three common encryption libraries (OpenSSL, GnuTLS, and NSS). This means that we can trace calls to multiple libraries within the same tool.</p><p>To achieve this functionality, the <code>find_library_path</code> function is first used to determine the library&#x27;s path. Then, depending on the library type, the corresponding <code>attach_</code> function is called to attach the eBPF program to the library function.</p><div class="relative"><pre><code class="language-c code-highlight"><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span>openssl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">char</span> <span class="token operator">*</span>openssl_path <span class="token operator">=</span> <span class="token function">find_library_path</span><span class="token punctuation">(</span><span class="token string">&quot;libssl.so&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;OpenSSL path: %s\n&quot;</span><span class="token punctuation">,</span> openssl_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token function">attach_openssl</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">&quot;/lib/x86_64-linux-gnu/libssl.so.3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span>gnutls<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">char</span> <span class="token operator">*</span>gnutls_path <span class="token operator">=</span> <span class="token function">find_library_path</span><span class="token punctuation">(</span><span class="token string">&quot;libgnutls.so&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;GnuTLS path: %s\n&quot;</span><span class="token punctuation">,</span> gnutls_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token function">attach_gnutls</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> gnutls_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span>nss<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">char</span> <span class="token operator">*</span>nss_path <span class="token operator">=</span> <span class="token function">find_library_path</span><span class="token punctuation">(</span><span class="token string">&quot;libnspr4.so&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;NSS path: %s\n&quot;</span><span class="token punctuation">,</span> nss_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token function">attach_nss</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> nss_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span></code></pre></div><p>This section primarily covers the attachment logic for the OpenSSL, GnuTLS, and NSS libraries. NSS is a set of security libraries designed for organizations, supporting the creation of secure client and server applications. Originally developed by Netscape, they are now maintained by Mozilla. The other two libraries have been introduced earlier and are not reiterated here.</p><h3 class="content-header" id="2-detailed-attachment-logic"><a class="break-words" href="#2-detailed-attachment-logic" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>2. Detailed Attachment Logic</h3><p>The specific <code>attach</code> functions are as follows:</p><div class="relative"><pre><code class="language-c code-highlight"><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">define</span> <span class="token function macro-name">__ATTACH_UPROBE</span><span class="token expression"><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> binary_path<span class="token punctuation">,</span> sym_name<span class="token punctuation">,</span> prog_name<span class="token punctuation">,</span> is_retprobe<span class="token punctuation">)</span>   </span><span class="token punctuation">\</span>
</span></span><span class="code-line"><span class="token macro property">    <span class="token expression"><span class="token keyword">do</span> <span class="token punctuation">{</span>                                                                       </span><span class="token punctuation">\</span>
</span></span><span class="code-line"><span class="token macro property">      <span class="token expression"><span class="token function">LIBBPF_OPTS</span><span class="token punctuation">(</span>bpf_uprobe_opts<span class="token punctuation">,</span> uprobe_opts<span class="token punctuation">,</span> <span class="token punctuation">.</span>func_name <span class="token operator">=</span> #sym_name<span class="token punctuation">,</span>        </span><span class="token punctuation">\</span>
</span></span><span class="code-line"><span class="token macro property">                  <span class="token expression"><span class="token punctuation">.</span>retprobe <span class="token operator">=</span> is_retprobe<span class="token punctuation">)</span><span class="token punctuation">;</span>                                    </span><span class="token punctuation">\</span>
</span></span><span class="code-line"><span class="token macro property">      <span class="token expression">skel<span class="token operator">-&gt;</span>links<span class="token punctuation">.</span>prog_name <span class="token operator">=</span> <span class="token function">bpf_program__attach_uprobe_opts</span><span class="token punctuation">(</span>                 </span><span class="token punctuation">\</span>
</span></span><span class="code-line"><span class="token macro property">          <span class="token expression">skel<span class="token operator">-&gt;</span>progs<span class="token punctuation">.</span>prog_name<span class="token punctuation">,</span> env<span class="token punctuation">.</span>pid<span class="token punctuation">,</span> binary_path<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>uprobe_opts<span class="token punctuation">)</span><span class="token punctuation">;</span>       </span><span class="token punctuation">\</span>
</span></span><span class="code-line"><span class="token macro property">    <span class="token expression"><span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>false<span class="token punctuation">)</span></span></span>
</span><span class="code-line">    
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">attach_openssl</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">sslsniff_bpf</span> <span class="token operator">*</span>skel<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>lib<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token function">ATTACH_UPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> SSL_write<span class="token punctuation">,</span> probe_SSL_rw_enter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ATTACH_URETPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> SSL_write<span class="token punctuation">,</span> probe_SSL_write_exit<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ATTACH_UPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> SSL_read<span class="token punctuation">,</span> probe_SSL_rw_enter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ATTACH_URETPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> SSL_read<span class="token punctuation">,</span> probe_SSL_read_exit<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span>latency <span class="token operator">&amp;&amp;</span> env<span class="token punctuation">.</span>handshake<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token function">ATTACH_UPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> SSL_do_handshake<span class="token punctuation">,</span>
</span><span class="code-line">                            probe_SSL_do_handshake_enter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token function">ATTACH_URETPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> SSL_do_handshake<span class="token punctuation">,</span>
</span><span class="code-line">                                probe_SSL_do_handshake_exit<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">attach_gnutls</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">sslsniff_bpf</span> <span class="token operator">*</span>skel<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>lib<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token function">ATTACH_UPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> gnutls_record_send<span class="token punctuation">,</span> probe_SSL_rw_enter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ATTACH_URETPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> gnutls_record_send<span class="token punctuation">,</span> probe_SSL_write_exit<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ATTACH_UPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> gnutls_record_recv<span class="token punctuation">,</span> probe_SSL_rw_enter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ATTACH_URETPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> gnutls_record_recv<span class="token punctuation">,</span> probe_SSL_read_exit<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">attach_nss</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">sslsniff_bpf</span> <span class="token operator">*</span>skel<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>lib<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token function">ATTACH_UPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> PR_Write<span class="token punctuation">,</span> probe_SSL_rw_enter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ATTACH_URETPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> PR_Write<span class="token punctuation">,</span> probe_SSL_write_exit<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ATTACH_UPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> PR_Send<span class="token punctuation">,</span> probe_SSL_rw_enter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ATTACH_URETPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> PR_Send<span class="token punctuation">,</span> probe_SSL_write_exit<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ATTACH_UPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> PR_Read<span class="token punctuation">,</span> probe_SSL_rw_enter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ATTACH_URETPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> PR_Read<span class="token punctuation">,</span> probe_SSL_read_exit<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ATTACH_UPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> PR_Recv<span class="token punctuation">,</span> probe_SSL_rw_enter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">ATTACH_URETPROBE_CHECKED</span><span class="token punctuation">(</span>skel<span class="token punctuation">,</span> lib<span class="token punctuation">,</span> PR_Recv<span class="token punctuation">,</span> probe_SSL_read_exit<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>We further examine the <code>attach_</code> function and can see that they both use the <code>ATTACH_UPROBE_CHECKED</code> and <code>ATTACH_URETPROBE_CHECKED</code> macros to implement specific mounting logic. These two macros are used respectively for setting uprobe (function entry) and uretprobe (function return).</p><p>Considering that different libraries have different API function names (for example, OpenSSL uses <code>SSL_write</code>, while GnuTLS uses <code>gnutls_record_send</code>), we need to write a separate <code>attach_</code> function for each library.</p><p>For instance, in the <code>attach_openssl</code> function, we set up probes for both <code>SSL_write</code> and <code>SSL_read</code>. If users also want to track handshake latency (<code>env.latency</code>) and the handshake process (<code>env.handshake</code>), we set up a probe for <code>SSL_do_handshake</code>.</p><p>In the eBPF ecosystem, <code>perf_buffer</code> is an efficient mechanism used to transfer data from kernel space to user space. This is particularly useful for kernel-space eBPF programs as they can&#x27;t directly interact with user space. With <code>perf_buffer</code>, we can collect data in kernel-space eBPF programs and then asynchronously read this data in user space. We use the <code>perf_buffer__poll</code> function to read data reported in kernel space, as shown below:</p><div class="relative"><pre><code class="language-c code-highlight"><span class="code-line"><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>exiting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    err <span class="token operator">=</span> <span class="token function">perf_buffer__poll</span><span class="token punctuation">(</span>pb<span class="token punctuation">,</span> PERF_POLL_TIMEOUT_MS<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> err <span class="token operator">!=</span> <span class="token operator">-</span>EINTR<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;error polling perf buffer: %s\n&quot;</span><span class="token punctuation">,</span> <span class="token function">strerror</span><span class="token punctuation">(</span><span class="token operator">-</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">goto</span> cleanup<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    err <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>Finally, in the <code>print_event</code> function, we print the data to standard output:</p><div class="relative"><pre><code class="language-c code-highlight"><span class="code-line"><span class="token comment">// Function to print the event from the perf buffer</span>
</span><span class="code-line"><span class="token keyword">void</span> <span class="token function">print_event</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">probe_SSL_data_t</span> <span class="token operator">*</span>event<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>buf_size <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span>hexdump<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token comment">// 2 characters for each byte + null terminator</span>
</span><span class="code-line">            <span class="token keyword">char</span> hex_data<span class="token punctuation">[</span>MAX_BUF_SIZE <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  
</span><span class="code-line">            <span class="token function">buf_to_hex</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>buf<span class="token punctuation">,</span> buf_size<span class="token punctuation">,</span> hex_data<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            
</span><span class="code-line">            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n%s\n&quot;</span><span class="token punctuation">,</span> s_mark<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>hex_data<span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%.32s\n&quot;</span><span class="token punctuation">,</span> hex_data <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token punctuation">}</span>
</span><span class="code-line">            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s\n\n&quot;</span><span class="token punctuation">,</span> e_mark<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;\n%s\n%s\n%s\n\n&quot;</span><span class="token punctuation">,</span> s_mark<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> e_mark<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>You can find the complete source code here: <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/eunomia-bpf/bpf-developer-tutorial/tree/main/src/30-sslsniff">https://github.com/eunomia-bpf/bpf-developer-tutorial/tree/main/src/30-sslsniff</a></p><h2 class="content-header" id="compilation-and-execution"><a class="break-words" href="#compilation-and-execution" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Compilation and Execution</h2><p>To start using <code>sslsniff</code>, you need to first compile it:</p><div class="relative"><pre><code class="code-highlight language-sh"><span class="code-line"><span class="token function">make</span>
</span></code></pre></div><p>Once done, follow these steps:</p><h3 class="content-header" id="start-sslsniff"><a class="break-words" href="#start-sslsniff" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a><strong>Start sslsniff</strong></h3><p>In a terminal, execute the following command to start <code>sslsniff</code>:</p><div class="relative"><pre><code class="code-highlight language-sh"><span class="code-line"><span class="token function">sudo</span> ./sslsniff
</span></code></pre></div><h3 class="content-header" id="execute-curl-command"><a class="break-words" href="#execute-curl-command" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a><strong>Execute CURL command</strong></h3><p>In another terminal, execute:</p><div class="relative"><pre><code class="code-highlight language-console"><span class="code-line">curl https://example.com
</span></code></pre></div><p>Under normal circumstances, you will see output similar to the following:</p><div class="relative"><pre><code class="code-highlight language-html"><span class="code-line">    <span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">doctype</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Example Domain<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">        ...
</span><span class="code-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">        ...
</span><span class="code-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</span></code></pre></div><h3 class="content-header" id="sslsniff-output"><a class="break-words" href="#sslsniff-output" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a><strong>sslsniff Output</strong></h3><p>After executing the <code>curl</code> command, <code>sslsniff</code> will display the following content:</p><div class="relative"><pre><code class="code-highlight language-txt"><span class="code-line">    READ/RECV    0.132786160        curl             47458   1256  
</span><span class="code-line">    ----- DATA -----
</span><span class="code-line">    &lt;!doctype html&gt;
</span><span class="code-line">    ...
</span><span class="code-line">    &lt;div&gt;
</span><span class="code-line">        &lt;h1&gt;Example Domain&lt;/h1&gt;
</span><span class="code-line">        ...
</span><span class="code-line">    &lt;/div&gt;
</span><span class="code-line">    &lt;/body&gt;
</span><span class="code-line">    &lt;/html&gt;
</span><span class="code-line">
</span><span class="code-line">    ----- END DATA -----
</span></code></pre></div><p><strong>Note</strong>: The displayed HTML content may vary depending on the specific content of the <code>example.com</code> page.</p><h3 class="content-header" id="displaying-latency-and-handshake-process"><a class="break-words" href="#displaying-latency-and-handshake-process" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Displaying Latency and Handshake Process</h3><p>To view latency and handshake process, execute the following command:</p><div class="relative"><pre><code class="code-highlight language-console"><span class="code-line">$ sudo ./sslsniff -l --handshake
</span><span class="code-line">OpenSSL path: /lib/x86_64-linux-gnu/libssl.so.3
</span><span class="code-line">GnuTLS path: /lib/x86_64-linux-gnu/libgnutls.so.30
</span><span class="code-line">NSS path: /lib/x86_64-linux-gnu/libnspr4.so
</span><span class="code-line">FUNC         TIME(s)            COMM             PID     LEN     LAT(ms)
</span><span class="code-line">HANDSHAKE    0.000000000        curl             6460    1      1.384  WRITE/SEND   0.000115400        curl             6460    24     0.014 
</span></code></pre></div><h3 class="content-header" id="hexadecimal-output"><a class="break-words" href="#hexadecimal-output" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Hexadecimal Output</h3><p>To display data in hexadecimal format, execute the following command:</p><div class="relative"><pre><code class="code-highlight language-console"><span class="code-line">$ sudo ./sslsniff --hexdump
</span><span class="code-line">WRITE/SEND   0.000000000        curl             16104   24    
</span><span class="code-line">----- DATA -----
</span><span class="code-line">505249202a20485454502f322e300d0a
</span><span class="code-line">0d0a534d0d0a0d0a
</span><span class="code-line">----- END DATA -----
</span><span class="code-line">
</span><span class="code-line">...
</span></code></pre></div><h2 class="content-header" id="summary"><a class="break-words" href="#summary" aria-hidden="true" tabindex="-1"><span class="content-header-link"><svg class="h-5 linkicon w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"></path><path d="M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"></path></svg></span></a>Summary</h2><p>eBPF is a very powerful technology that can help us gain deeper insights into how a system works. This tutorial is a simple example demonstrating how to use eBPF to monitor SSL/TLS communication. If you&#x27;re interested in eBPF technology and want to learn more and practice further, you can visit our tutorial code repository at <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/eunomia-bpf/bpf-developer-tutorial">https://github.com/eunomia-bpf/bpf-developer-tutorial</a> and tutorial website at <a class="break-words" target="_blank" rel="noopener noreferrer" href="https://eunomia.dev/zh/tutorials/">https://eunomia.dev/zh/tutorials/</a>.</p><p>References:</p><ul><li><a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/iovisor/bcc/pull/4706">https://github.com/iovisor/bcc/pull/4706</a></li><li><a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/openssl/openssl">https://github.com/openssl/openssl</a></li><li><a class="break-words" target="_blank" rel="noopener noreferrer" href="https://www.openssl.org/docs/man1.1.1/man3/SSL_read.html">https://www.openssl.org/docs/man1.1.1/man3/SSL_read.html</a></li><li><a class="break-words" target="_blank" rel="noopener noreferrer" href="https://github.com/iovisor/bcc/blob/master/tools/sslsniff_example.txt">https://github.com/iovisor/bcc/blob/master/tools/sslsniff_example.txt</a></li><li><a class="break-words" target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Transport_Layer_Security">https://en.wikipedia.org/wiki/Transport_Layer_Security</a></li></ul></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300 glass p-4 rounded-xl"><a class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors" target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=https%3A%2F%2Fwww.yunwei37.com%2Fblog%2Fssl-uprobe">Discuss on Twitter</a> • <a class="hover:text-primary-600 dark:hover:text-primary-400 transition-colors" target="_blank" rel="noopener noreferrer" href="https://github.com/yunwei37/yunwei37-blog/blob/main/data/blog/ssl-uprobe.mdx">View on GitHub</a></div><div class="pt-6 pb-6 text-center text-gray-700 dark:text-gray-300 glass p-6 rounded-xl" id="comment"><button>Load Comments</button></div></div><footer><div class="divide-gray-200/30 text-sm leading-5 font-medium xl:col-start-1 xl:row-start-2 xl:divide-y dark:divide-gray-700/30"><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-600 uppercase dark:text-gray-300 mb-4">Tags</h2><div class="flex flex-wrap gap-2"><a class="inline-block px-3 py-1 text-xs font-medium uppercase tracking-wide bg-primary-100 hover:bg-primary-200 dark:bg-primary-900/30 dark:hover:bg-primary-800/40 rounded-full transition-all duration-200 text-primary-800 hover:text-primary-900 dark:text-primary-300 dark:hover:text-primary-200 border border-primary-200/50 dark:border-primary-700/50" href="/tags/ebpf">ebpf</a><a class="inline-block px-3 py-1 text-xs font-medium uppercase tracking-wide bg-primary-100 hover:bg-primary-200 dark:bg-primary-900/30 dark:hover:bg-primary-800/40 rounded-full transition-all duration-200 text-primary-800 hover:text-primary-900 dark:text-primary-300 dark:hover:text-primary-200 border border-primary-200/50 dark:border-primary-700/50" href="/tags/tutorial">tutorial</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-6 xl:py-8"><div class="glass p-4 rounded-xl"><h2 class="text-xs tracking-wide text-gray-600 uppercase dark:text-gray-300 mb-2">Previous Article</h2><div class="text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 transition-colors"><a class="break-words" href="/blog/ebpf-wasm">When Wasm Meets eBPF: Writing, Distributing, Loading, and Running eBPF Programs with WebAssembly</a></div></div><div class="glass p-4 rounded-xl"><h2 class="text-xs tracking-wide text-gray-600 uppercase dark:text-gray-300 mb-2">Next Article</h2><div class="text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 transition-colors"><a class="break-words" href="/blog/natual-language-program">自然语言编程: 从 AutoGPT 往前迈的一小步</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="inline-flex items-center glass px-4 py-2 rounded-xl text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 transition-all duration-200 hover:scale-105" aria-label="Back to the blog" href="/blog">← Back to the blog</a></div></footer></div></div></article></section><!--$--><!--/$--></main><footer class="border-t border-gray-200/30 dark:border-gray-700/30 pt-8"><div class="flex flex-col items-center space-y-6"><div class="flex flex-wrap justify-center gap-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:yunwei356@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>Mail</title><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/yunwei37"><span class="sr-only">github</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://facebook.com"><span class="sr-only">facebook</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>Facebook</title><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://youtube.com"><span class="sr-only">youtube</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>Youtube</title><path d="M23.499 6.203a3.008 3.008 0 00-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 00-2.088 2.09A31.258 31.26 0 000 12.01a31.258 31.26 0 00.523 5.785 3.008 3.008 0 002.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 002.089-2.09 31.258 31.26 0 00.5-5.784 31.258 31.26 0 00-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/yusheng-zheng-611920280"><span class="sr-only">linkedin</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>Linkedin</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://bsky.app/"><span class="sr-only">bluesky</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>Bluesky</title><path d="M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565C.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479c.815 2.736 3.713 3.66 6.383 3.364q.204-.03.415-.056q-.207.033-.415.056c-3.912.58-7.387 2.005-2.83 7.078c5.013 5.19 6.87-1.113 7.823-4.308c.953 3.195 2.05 9.271 7.733 4.308c4.267-4.308 1.172-6.498-2.74-7.078a9 9 0 0 1-.415-.056q.21.026.415.056c2.67.297 5.568-.628 6.383-3.364c.246-.828.624-5.79.624-6.478c0-.69-.139-1.861-.902-2.206c-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://x.com/yunwei37"><span class="sr-only">x</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>X</title><path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.instagram.com"><span class="sr-only">instagram</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>Instagram</title><path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.threads.net"><span class="sr-only">threads</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>Threads</title><path d="M12.186 24h-.007c-3.581-.024-6.334-1.205-8.184-3.509C2.35 18.44 1.5 15.586 1.472 12.01v-.017c.03-3.579.879-6.43 2.525-8.482C5.845 1.205 8.6.024 12.18 0h.014c2.746.02 5.043.725 6.826 2.098 1.677 1.29 2.858 3.13 3.509 5.467l-2.04.569c-1.104-3.96-3.898-5.984-8.304-6.015-2.91.022-5.11.936-6.54 2.717C4.307 6.504 3.616 8.914 3.589 12c.027 3.086.718 5.496 2.057 7.164 1.43 1.783 3.631 2.698 6.54 2.717 2.623-.02 4.358-.631 5.8-2.045 1.647-1.613 1.618-3.593 1.09-4.798-.31-.71-.873-1.3-1.634-1.75-.192 1.352-.622 2.446-1.284 3.272-.886 1.102-2.14 1.704-3.73 1.79-1.202.065-2.361-.218-3.259-.801-1.063-.689-1.685-1.74-1.752-2.964-.065-1.19.408-2.285 1.33-3.082.88-.76 2.119-1.207 3.583-1.291a13.853 13.853 0 0 1 3.02.142c-.126-.742-.375-1.332-.75-1.757-.513-.586-1.308-.883-2.359-.89h-.029c-.844 0-1.992.232-2.721 1.32L7.734 7.847c.98-1.454 2.568-2.256 4.478-2.256h.044c3.194.02 5.097 1.975 5.287 5.388.108.046.216.094.321.142 1.49.7 2.58 1.761 3.154 3.07.797 1.82.871 4.79-1.548 7.158-1.85 1.81-4.094 2.628-7.277 2.65Zm1.003-11.69c-.242 0-.487.007-.739.021-1.836.103-2.98.946-2.916 2.143.067 1.256 1.452 1.839 2.784 1.767 1.224-.065 2.818-.543 3.086-3.71a10.5 10.5 0 0 0-2.215-.221z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://medium.com"><span class="sr-only">medium</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6"><title>Medium</title><path d="M13.54 12a6.8 6.8 0 01-6.77 6.82A6.8 6.8 0 010 12a6.8 6.8 0 016.77-6.82A6.8 6.8 0 0113.54 12zM20.96 12c0 3.54-1.51 6.42-3.38 6.42-1.87 0-3.39-2.88-3.39-6.42s1.52-6.42 3.39-6.42 3.38 2.88 3.38 6.42M24 12c0 3.17-.53 5.75-1.19 5.75-.66 0-1.19-2.58-1.19-5.75s.53-5.75 1.19-5.75C23.47 6.25 24 8.83 24 12z"></path></svg></a></div><div class="flex space-x-2 text-sm opacity-80"><div>Yusheng Zheng</div><div> • </div><div>© 2026</div><div> • </div><a class="hover:text-primary-500 transition-colors" href="/">云微的胡思乱想</a></div><div class="text-sm opacity-60"><a class="hover:text-primary-500 transition-colors" target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div><script src="/_next/static/chunks/webpack-91cf1b3b084c6ba2.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1478,[\"874\",\"static/chunks/874-8edb22cc7428423c.js\",\"650\",\"static/chunks/650-5bb235cd9bfca45d.js\",\"177\",\"static/chunks/app/layout-66df3ac28fcfbced.js\"],\"ThemeProviders\"]\n3:I[4091,[\"874\",\"static/chunks/874-8edb22cc7428423c.js\",\"650\",\"static/chunks/650-5bb235cd9bfca45d.js\",\"177\",\"static/chunks/app/layout-66df3ac28fcfbced.js\"],\"default\"]\n4:I[9243,[\"874\",\"static/chunks/874-8edb22cc7428423c.js\",\"650\",\"static/chunks/650-5bb235cd9bfca45d.js\",\"177\",\"static/chunks/app/layout-66df3ac28fcfbced.js\"],\"\"]\n5:I[7392,[\"874\",\"static/chunks/874-8edb22cc7428423c.js\",\"650\",\"static/chunks/650-5bb235cd9bfca45d.js\",\"177\",\"static/chunks/app/layout-66df3ac28fcfbced.js\"],\"KBarSearchProvider\"]\n6:I[6874,[\"874\",\"static/chunks/874-8edb22cc7428423c.js\",\"63\",\"static/chunks/63-d245e42a784ca56d.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-1ed2702378ba9d6b.js\"],\"\"]\ne:I[8393,[],\"\"]\n:HL[\"/_next/static/media/36966cca54120369-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/4ac7c0f872b74ee7.css\",\"style\"]\n:HL[\"/_next/static/css/a06d7e24bf9a7d93.css\",\"style\"]\n:HL[\"/_next/static/css/7246298b30c42979.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"MYXrWUjg0HELsl6zLYF_6\",\"p\":\"\",\"c\":[\"\",\"blog\",\"ssl-uprobe\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"ssl-uprobe\",\"c\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4ac7c0f872b74ee7.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/a06d7e24bf9a7d93.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en-us\",\"className\":\"__variable_dd5b2f scroll-smooth\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"76x76\",\"href\":\"/static/favicons/apple-touch-icon.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/svg+xml\",\"href\":\"/static/favicons/favicon.svg\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"32x32\",\"href\":\"/static/favicons/favicon-32x32.png\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"16x16\",\"href\":\"/static/favicons/favicon-16x16.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/static/favicons/site.webmanifest\"}],[\"$\",\"link\",null,{\"rel\":\"mask-icon\",\"href\":\"/static/favicons/safari-pinned-tab.svg\",\"color\":\"#5bbad5\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#000000\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: light)\",\"content\":\"#fff\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"media\":\"(prefers-color-scheme: dark)\",\"content\":\"#000\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/feed.xml\"}],[\"$\",\"body\",null,{\"className\":\"pl-[calc(100vw-100%)] text-black antialiased dark:text-white min-h-screen\",\"children\":[\"$\",\"$L2\",null,{\"children\":[[\"$\",\"$L3\",null,{}],[\"$undefined\",\"$undefined\",\"$undefined\",[\"$\",\"$L4\",null,{\"async\":true,\"defer\":true,\"src\":\"https://analytics.umami.is/script.js\"}],\"$undefined\",\"$undefined\"],[\"$\",\"div\",null,{\"className\":\"min-h-screen flex flex-col justify-center py-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"content-glass mx-auto w-full max-w-5xl px-4 sm:px-6 xl:px-8 py-8\",\"children\":[\"$\",\"$L5\",null,{\"kbarConfig\":{\"searchDocumentsPath\":\"/search.json\"},\"children\":[[\"$\",\"header\",null,{\"className\":\"flex items-center w-full justify-between py-6 border-b border-gray-200/30 dark:border-gray-700/30\",\"children\":[[\"$\",\"$L6\",null,{\"className\":\"break-words\",\"href\":\"/\",\"aria-label\":\"yunwei37\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mr-3\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":40,\"height\":40,\"fill\":\"none\",\"children\":[[\"$\",\"defs\",null,{\"children\":[[\"$\",\"linearGradient\",null,{\"id\":\"logo_svg__a\",\"x1\":\"0%\",\"x2\":\"100%\",\"y1\":\"0%\",\"y2\":\"100%\",\"children\":[[\"$\",\"stop\",null,{\"offset\":\"0%\",\"style\":{\"stopColor\":\"#3b82f6\",\"stopOpacity\":1}}],[\"$\",\"stop\",null,{\"offset\":\"100%\",\"style\":{\"stopColor\":\"#06b6d4\",\"stopOpacity\":1}}]]}],[\"$\",\"linearGradient\",null,{\"id\":\"logo_svg__b\",\"x1\":\"0%\",\"x2\":\"100%\",\"y1\":\"0%\",\"y2\":\"100%\",\"children\":[[\"$\",\"stop\",null,{\"offset\":\"0%\",\"style\":{\"stopColor\":\"#8b5cf6\",\"stopOpacity\":1}}],[\"$\",\"stop\",null,{\"offset\":\"100%\",\"style\":{\"stopColor\":\"#3b82f6\",\"stopOpacity\":1}}]]}]]}],[\"$\",\"circle\",null,{\"cx\":20,\"cy\":20,\"r\":18,\"fill\":\"url(#logo_svg__a)\",\"opacity\":0.1}],[\"$\",\"path\",null,{\"fill\":\"url(#logo_svg__a)\",\"d\":\"m12 8 6 10v10h4V18l6-10h-4l-4 6-4-6Z\"}],[\"$\",\"path\",null,{\"fill\":\"url(#logo_svg__b)\",\"d\":\"m8 24 4 8 4-8 4 8 4-8h8v4h-6l-4 8-4-8-4 8-4-8H8Z\",\"opacity\":0.8}],[\"$\",\"circle\",null,{\"cx\":32,\"cy\":12,\"r\":2,\"fill\":\"url(#logo_svg__b)\"}],[\"$\",\"circle\",null,{\"cx\":8,\"cy\":12,\"r\":1.5,\"fill\":\"url(#logo_svg__a)\",\"opacity\":0.6}]]}]}],[\"$\",\"div\",null,{\"className\":\"hidden text-2xl font-bold sm:block hover:text-primary-600 dark:hover:text-primary-400 transition-colors\",\"children\":\"yunwei37\"}]]}]}],[\"$\",\"div\",null,{\"className\":\"flex items-center space-x-4\",\"children\":[[\"$\",\"div\",null,{\"className\":\"no-scrollbar hidden items-center space-x-2 sm:flex\",\"children\":[[\"$\",\"$L6\",\"Blog\",{\"className\":\"px-3 py-2 rounded-lg transition-all duration-200 font-medium hover:text-primary-600 dark:hover:text-primary-400\",\"href\":\"/blog\",\"children\":\"Blog\"}],[\"$\",\"$L6\",\"Docs\",{\"className\":\"px-3 py-2 rounded-lg transition-all duration-200 font-medium hover:text-primary-600 dark:hover:text-primary-400\",\"href\":\"/docs\",\"children\":\"Docs\"}],[\"$\",\"$L6\",\"Tags\",{\"className\":\"px-3 py-2 rounded-lg transition-all duration-200 font-medium hover:text-primary-600 dark:hover:text-primary-400\",\"href\":\"/tags\",\"children\":\"Tags\"}],[\"$\",\"$L6\",\"About\",{\"className\":\"px-3 py-2 rounded-lg transition-all duration-200 font-medium hover:text-primary-600 dark:hover:text-primary-400\",\"href\":\"/about\",\"children\":\"About\"}]]}],\"$L7\"]}]]}],\"$L8\",\"$L9\"]}]}]}]]}]}]]}]]}],{\"children\":[\"blog\",\"$La\",{\"children\":[[\"slug\",\"ssl-uprobe\",\"c\"],\"$Lb\",{\"children\":[\"__PAGE__\",\"$Lc\",{},null,false]},null,false]},null,false]},null,false],\"$Ld\",false]],\"m\":\"$undefined\",\"G\":[\"$e\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"f:I[4159,[\"874\",\"static/chunks/874-8edb22cc7428423c.js\",\"650\",\"static/chunks/650-5bb235cd9bfca45d.js\",\"177\",\"static/chunks/app/layout-66df3ac28fcfbced.js\"],\"KBarButton\"]\n10:I[1762,[\"874\",\"static/chunks/874-8edb22cc7428423c.js\",\"650\",\"static/chunks/650-5bb235cd9bfca45d.js\",\"177\",\"static/chunks/app/layout-66df3ac28fcfbced.js\"],\"default\"]\n11:I[7298,[\"874\",\"static/chunks/874-8edb22cc7428423c.js\",\"650\",\"static/chunks/650-5bb235cd9bfca45d.js\",\"177\",\"static/chunks/app/layout-66df3ac28fcfbced.js\"],\"default\"]\n12:I[7555,[],\"\"]\n13:I[1295,[],\"\"]\n1e:I[9665,[],\"OutletBoundary\"]\n20:I[4911,[],\"AsyncMetadataOutlet\"]\n22:I[9665,[],\"ViewportBoundary\"]\n24:I[9665,[],\"MetadataBoundary\"]\n25:\"$Sreact.suspense\"\n7:[\"$\",\"div\",null,{\"className\":\"flex items-center space-x-2\",\"children\":[[\"$\",\"$Lf\",null,{\"aria-label\":\"Search\",\"className\":\"p-2 rounded-lg transition-all duration-200\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"fill\":\"none\",\"viewBox\":\"0 0 24 24\",\"strokeWidth\":1.5,\"stroke\":\"currentColor\",\"className\":\"h-6 w-6 hover:text-primary-600 dark:hover:text-primary-400 transition-colors\",\"children\":[\"$\",\"path\",null,{\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"d\":\"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z\"}]}]}],[\"$\",\"$L10\",null,{}],[\"$\",\"$L11\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"8:[\"$\",\"main\",null,{\"className\":\"py-6\",\"children\":[\"$\",\"$L12\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L13\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6\",\"children\":[[\"$\",\"div\",null,{\"className\":\"space-x-2 pt-6 pb-8 md:space-y-5\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-6xl leading-9 font-extrabold tracking-tight md:border-r-2 md:px-6 md:text-8xl md:leading-14\",\"children\":\"404\"}]}],[\"$\",\"div\",null,{\"className\":\"max-w-md\",\"children\":[[\"$\",\"p\",null,{\"className\":\"mb-4 text-xl leading-normal font-bold md:text-2xl\",\"children\":\"Sorry we couldn't find this page.\"}],[\"$\",\"p\",null,{\"className\":\"mb-8\",\"children\":\"But dont worry, you can find plenty of other things on our homepage.\"}],[\"$\",\"$L6\",null,{\"className\":\"focus:shadow-outline-blue inline rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-sm leading-5 font-medium text-white shadow-xs transition-colors duration-150 hover:bg-blue-700 focus:outline-hidden dark:hover:bg-blue-500\",\"href\":\"/\",\"children\":\"Back to homepage\"}]]}]]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]\n"])</script><script>self.__next_f.push([1,"9:[\"$\",\"footer\",null,{\"className\":\"border-t border-gray-200/30 dark:border-gray-700/30 pt-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center space-y-6\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-wrap justify-center gap-4\",\"children\":[[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"mailto:yunwei356@gmail.com\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"mail\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"Mail\"}],[\"$\",\"path\",null,{\"d\":\"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z\"}],[\"$\",\"path\",null,{\"d\":\"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z\"}]]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/yunwei37\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"github\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"GitHub\"}],[\"$\",\"path\",null,{\"d\":\"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12\"}]]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://facebook.com\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"facebook\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"Facebook\"}],[\"$\",\"path\",null,{\"d\":\"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z\"}]]}]]}],[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://youtube.com\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"youtube\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"Youtube\"}],[\"$\",\"path\",null,{\"d\":\"M23.499 6.203a3.008 3.008 0 00-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 00-2.088 2.09A31.258 31.26 0 000 12.01a31.258 31.26 0 00.523 5.785 3.008 3.008 0 002.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 002.089-2.09 31.258 31.26 0 00.5-5.784 31.258 31.26 0 00-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z\"}]]}]]}],\"$L14\",\"$L15\",\"$L16\",\"$L17\",\"$L18\",\"$L19\",\"$L1a\"]}],\"$L1b\",\"$L1c\"]}]}]\n"])</script><script>self.__next_f.push([1,"a:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L12\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L13\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\nb:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L12\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L13\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\nc:[\"$\",\"$1\",\"c\",{\"children\":[\"$L1d\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/7246298b30c42979.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L1e\",null,{\"children\":[\"$L1f\",[\"$\",\"$L20\",null,{\"promise\":\"$@21\"}]]}]]}]\nd:[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$L22\",null,{\"children\":\"$L23\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$L24\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$25\",null,{\"fallback\":null,\"children\":\"$L26\"}]}]}]]}]\n"])</script><script>self.__next_f.push([1,"14:[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.linkedin.com/in/yusheng-zheng-611920280\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"linkedin\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"Linkedin\"}],[\"$\",\"path\",null,{\"d\":\"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z\"}]]}]]}]\n"])</script><script>self.__next_f.push([1,"15:null\n"])</script><script>self.__next_f.push([1,"16:[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://bsky.app/\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"bluesky\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"Bluesky\"}],[\"$\",\"path\",null,{\"d\":\"M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565C.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479c.815 2.736 3.713 3.66 6.383 3.364q.204-.03.415-.056q-.207.033-.415.056c-3.912.58-7.387 2.005-2.83 7.078c5.013 5.19 6.87-1.113 7.823-4.308c.953 3.195 2.05 9.271 7.733 4.308c4.267-4.308 1.172-6.498-2.74-7.078a9 9 0 0 1-.415-.056q.21.026.415.056c2.67.297 5.568-.628 6.383-3.364c.246-.828.624-5.79.624-6.478c0-.69-.139-1.861-.902-2.206c-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8\"}]]}]]}]\n"])</script><script>self.__next_f.push([1,"17:[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://x.com/yunwei37\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"x\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"X\"}],[\"$\",\"path\",null,{\"d\":\"M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z\"}]]}]]}]\n27:T69f,"])</script><script>self.__next_f.push([1,"M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"])</script><script>self.__next_f.push([1,"18:[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.instagram.com\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"instagram\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"Instagram\"}],[\"$\",\"path\",null,{\"d\":\"$27\"}]]}]]}]\n28:T498,"])</script><script>self.__next_f.push([1,"M12.186 24h-.007c-3.581-.024-6.334-1.205-8.184-3.509C2.35 18.44 1.5 15.586 1.472 12.01v-.017c.03-3.579.879-6.43 2.525-8.482C5.845 1.205 8.6.024 12.18 0h.014c2.746.02 5.043.725 6.826 2.098 1.677 1.29 2.858 3.13 3.509 5.467l-2.04.569c-1.104-3.96-3.898-5.984-8.304-6.015-2.91.022-5.11.936-6.54 2.717C4.307 6.504 3.616 8.914 3.589 12c.027 3.086.718 5.496 2.057 7.164 1.43 1.783 3.631 2.698 6.54 2.717 2.623-.02 4.358-.631 5.8-2.045 1.647-1.613 1.618-3.593 1.09-4.798-.31-.71-.873-1.3-1.634-1.75-.192 1.352-.622 2.446-1.284 3.272-.886 1.102-2.14 1.704-3.73 1.79-1.202.065-2.361-.218-3.259-.801-1.063-.689-1.685-1.74-1.752-2.964-.065-1.19.408-2.285 1.33-3.082.88-.76 2.119-1.207 3.583-1.291a13.853 13.853 0 0 1 3.02.142c-.126-.742-.375-1.332-.75-1.757-.513-.586-1.308-.883-2.359-.89h-.029c-.844 0-1.992.232-2.721 1.32L7.734 7.847c.98-1.454 2.568-2.256 4.478-2.256h.044c3.194.02 5.097 1.975 5.287 5.388.108.046.216.094.321.142 1.49.7 2.58 1.761 3.154 3.07.797 1.82.871 4.79-1.548 7.158-1.85 1.81-4.094 2.628-7.277 2.65Zm1.003-11.69c-.242 0-.487.007-.739.021-1.836.103-2.98.946-2.916 2.143.067 1.256 1.452 1.839 2.784 1.767 1.224-.065 2.818-.543 3.086-3.71a10.5 10.5 0 0 0-2.215-.221z"])</script><script>self.__next_f.push([1,"19:[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.threads.net\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"threads\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"Threads\"}],[\"$\",\"path\",null,{\"d\":\"$28\"}]]}]]}]\n"])</script><script>self.__next_f.push([1,"1a:[\"$\",\"a\",null,{\"className\":\"text-sm text-gray-500 transition hover:text-gray-600\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://medium.com\",\"children\":[[\"$\",\"span\",null,{\"className\":\"sr-only\",\"children\":\"medium\"}],[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"className\":\"hover:text-primary-500 dark:hover:text-primary-400 fill-current text-gray-700 dark:text-gray-200 h-6 w-6\",\"children\":[[\"$\",\"title\",null,{\"children\":\"Medium\"}],[\"$\",\"path\",null,{\"d\":\"M13.54 12a6.8 6.8 0 01-6.77 6.82A6.8 6.8 0 010 12a6.8 6.8 0 016.77-6.82A6.8 6.8 0 0113.54 12zM20.96 12c0 3.54-1.51 6.42-3.38 6.42-1.87 0-3.39-2.88-3.39-6.42s1.52-6.42 3.39-6.42 3.38 2.88 3.38 6.42M24 12c0 3.17-.53 5.75-1.19 5.75-.66 0-1.19-2.58-1.19-5.75s.53-5.75 1.19-5.75C23.47 6.25 24 8.83 24 12z\"}]]}]]}]\n"])</script><script>self.__next_f.push([1,"1b:[\"$\",\"div\",null,{\"className\":\"flex space-x-2 text-sm opacity-80\",\"children\":[[\"$\",\"div\",null,{\"children\":\"Yusheng Zheng\"}],[\"$\",\"div\",null,{\"children\":\" • \"}],[\"$\",\"div\",null,{\"children\":\"© 2026\"}],[\"$\",\"div\",null,{\"children\":\" • \"}],[\"$\",\"$L6\",null,{\"className\":\"hover:text-primary-500 transition-colors\",\"href\":\"/\",\"children\":\"云微的胡思乱想\"}]]}]\n1c:[\"$\",\"div\",null,{\"className\":\"text-sm opacity-60\",\"children\":[\"$\",\"a\",null,{\"className\":\"hover:text-primary-500 transition-colors\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/timlrx/tailwind-nextjs-starter-blog\",\"children\":\"Tailwind Nextjs Theme\"}]}]\n"])</script><script>self.__next_f.push([1,"29:I[1839,[\"874\",\"static/chunks/874-8edb22cc7428423c.js\",\"63\",\"static/chunks/63-d245e42a784ca56d.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-1ed2702378ba9d6b.js\"],\"default\"]\n2a:I[3063,[\"874\",\"static/chunks/874-8edb22cc7428423c.js\",\"63\",\"static/chunks/63-d245e42a784ca56d.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-1ed2702378ba9d6b.js\"],\"Image\"]\n"])</script><script>self.__next_f.push([1,"1d:[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"BlogPosting\\\",\\\"headline\\\":\\\"eBPF Practical Tutorial: Capturing SSL/TLS Plain Text Data Using uprobe\\\",\\\"datePublished\\\":\\\"2023-06-14T02:41:06.000Z\\\",\\\"dateModified\\\":\\\"2023-06-14T02:41:06.000Z\\\",\\\"image\\\":\\\"/static/images/twitter-card.png\\\",\\\"url\\\":\\\"https://www.yunwei37.com/blog/ssl-uprobe\\\",\\\"author\\\":[{\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"Yusheng Zheng (云微)\\\"}]}\"}}],[\"$\",\"section\",null,{\"className\":\"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0\",\"children\":[[\"$\",\"$L29\",null,{}],[\"$\",\"article\",null,{\"className\":\"content-glass p-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"xl:divide-y xl:divide-gray-200/30 xl:dark:divide-gray-700/30\",\"children\":[[\"$\",\"header\",null,{\"className\":\"pt-6 xl:pb-6\",\"children\":[\"$\",\"div\",null,{\"className\":\"space-y-4 text-center\",\"children\":[[\"$\",\"dl\",null,{\"className\":\"space-y-4\",\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Published on\"}],[\"$\",\"dd\",null,{\"className\":\"text-base leading-6 font-medium text-gray-600 dark:text-gray-300\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2023-06-14T02:41:06.000Z\",\"children\":\"Wednesday, June 14, 2023\"}]}]]}]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"h1\",null,{\"className\":\"text-3xl leading-9 font-extrabold tracking-tight sm:text-4xl sm:leading-10 md:text-5xl md:leading-14\",\"children\":\"eBPF Practical Tutorial: Capturing SSL/TLS Plain Text Data Using uprobe\"}]}]]}]}],[\"$\",\"div\",null,{\"className\":\"grid-rows-[auto_1fr] divide-y divide-gray-200/30 pb-8 xl:grid xl:grid-cols-4 xl:gap-x-8 xl:divide-y-0 dark:divide-gray-700/30\",\"children\":[[\"$\",\"dl\",null,{\"className\":\"pt-6 pb-10 xl:border-b xl:border-gray-200/30 xl:pt-11 xl:dark:border-gray-700/30\",\"children\":[[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Authors\"}],[\"$\",\"dd\",null,{\"children\":[\"$\",\"ul\",null,{\"className\":\"flex flex-wrap justify-center gap-4 sm:space-x-12 xl:block xl:space-y-6 xl:space-x-0\",\"children\":[[\"$\",\"li\",\"Yusheng Zheng (云微)\",{\"className\":\"flex items-center space-x-3 glass p-4 rounded-xl\",\"children\":[[\"$\",\"$L2a\",null,{\"src\":\"/static/images/avatar.png\",\"width\":38,\"height\":38,\"alt\":\"avatar\",\"className\":\"h-10 w-10 rounded-full\"}],[\"$\",\"dl\",null,{\"className\":\"text-sm leading-5 font-medium whitespace-nowrap\",\"children\":[[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Name\"}],[\"$\",\"dd\",null,{\"className\":\"text-gray-900 dark:text-gray-100\",\"children\":\"Yusheng Zheng (云微)\"}],[\"$\",\"dt\",null,{\"className\":\"sr-only\",\"children\":\"Twitter\"}],[\"$\",\"dd\",null,{\"children\":[\"$\",\"a\",null,{\"className\":\"text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 transition-colors\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://twitter.com/yunwei37\",\"children\":\"@yunwei37\"}]}]]}]]}]]}]}]]}],[\"$\",\"div\",null,{\"className\":\"divide-y divide-gray-200/30 xl:col-span-3 xl:row-span-2 xl:pb-0 dark:divide-gray-700/30\",\"children\":[[\"$\",\"div\",null,{\"className\":\"prose dark:prose-invert max-w-none pt-10 pb-8 text-gray-700 dark:text-gray-200\",\"children\":[[\"$\",\"p\",null,{\"children\":\"With the widespread use of TLS in modern network environments, tracing microservices RPC messages has become increasingly challenging. Traditional traffic sniffing techniques often face limitations in accessing only encrypted data, preventing a genuine observation of the original communication content. This restriction poses significant obstacles to system debugging and analysis.\"}],[\"$\",\"p\",null,{\"children\":\"However, a new solution is now available. Through the use of eBPF technology and its capability to perform probing in user space, a method has emerged to regain plain text data, allowing us to intuitively view the pre-encrypted communication content. Nevertheless, each application might utilize different libraries, and each library comes in multiple versions, introducing complexity to the tracking process.\"}],\"$L2b\",\"$L2c\",\"$L2d\",\"$L2e\",\"$L2f\",\"$L30\",\"$L31\",\"$L32\",\"$L33\",\"$L34\",\"$L35\",\"$L36\",\"$L37\",\"$L38\",\"$L39\",\"$L3a\",\"$L3b\",\"$L3c\",\"$L3d\",\"$L3e\",\"$L3f\",\"$L40\",\"$L41\",\"$L42\",\"$L43\",\"$L44\",\"$L45\",\"$L46\",\"$L47\",\"$L48\",\"$L49\",\"$L4a\",\"$L4b\",\"$L4c\",\"$L4d\",\"$L4e\",\"$L4f\",\"$L50\",\"$L51\",\"$L52\",\"$L53\",\"$L54\",\"$L55\",\"$L56\",\"$L57\",\"$L58\",\"$L59\",\"$L5a\",\"$L5b\",\"$L5c\",\"$L5d\",\"$L5e\",\"$L5f\",\"$L60\",\"$L61\",\"$L62\",\"$L63\",\"$L64\",\"$L65\",\"$L66\",\"$L67\",\"$L68\",\"$L69\",\"$L6a\",\"$L6b\",\"$L6c\",\"$L6d\",\"$L6e\",\"$L6f\",\"$L70\",\"$L71\",\"$L72\",\"$L73\",\"$L74\",\"$L75\",\"$L76\",\"$L77\",\"$L78\",\"$L79\",\"$L7a\",\"$L7b\",\"$L7c\",\"$L7d\",\"$L7e\",\"$L7f\",\"$L80\",\"$L81\",\"$L82\",\"$L83\",\"$L84\",\"$L85\",\"$L86\",\"$L87\",\"$L88\",\"$L89\",\"$L8a\",\"$L8b\",\"$L8c\",\"$L8d\",\"$L8e\",\"$L8f\",\"$L90\",\"$L91\",\"$L92\"]}],\"$L93\",\"$L94\"]}],\"$L95\"]}]]}]}]]}]]\n"])</script><script>self.__next_f.push([1,"96:I[2100,[\"874\",\"static/chunks/874-8edb22cc7428423c.js\",\"63\",\"static/chunks/63-d245e42a784ca56d.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-1ed2702378ba9d6b.js\"],\"default\"]\n126:I[1449,[\"874\",\"static/chunks/874-8edb22cc7428423c.js\",\"63\",\"static/chunks/63-d245e42a784ca56d.js\",\"909\",\"static/chunks/app/blog/%5B...slug%5D/page-1ed2702378ba9d6b.js\"],\"default\"]\n2b:[\"$\",\"p\",null,{\"children\":\"In this tutorial, we will guide you through an eBPF tracing technique that spans across various user-space SSL/TLS libraries. This technique not only allows simultaneous tracing of user-space libraries like GnuTLS and OpenSSL but also significantly reduces maintenance efforts for new library versions compared to previous methods.\"}]\n"])</script><script>self.__next_f.push([1,"2c:[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"background-knowledge\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#background-knowledge\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Background Knowledge\"]}]\n"])</script><script>self.__next_f.push([1,"2d:[\"$\",\"p\",null,{\"children\":\"Before delving into the main topic of this tutorial, we need to grasp some core concepts that will serve as the foundation for our subsequent discussions.\"}]\n"])</script><script>self.__next_f.push([1,"2e:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"ssl-and-tls\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#ssl-and-tls\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"SSL and TLS\"]}]\n"])</script><script>self.__next_f.push([1,"2f:[\"$\",\"p\",null,{\"children\":\"SSL (Secure Sockets Layer): Developed by Netscape in the early 1990s, SSL provides data encryption for communication between two machines on a network. However, due to known security vulnerabilities, SSL has been succeeded by its successor, TLS.\"}]\n30:[\"$\",\"p\",null,{\"children\":\"TLS (Transport Layer Security): TLS is the successor to SSL, aiming to provide stronger and more secure data encryption methods. TLS operates through a handshake process during which a client and a server select an encryption algorithm and corresponding keys. Once the handshake is complete, data transmission begins, with all data being encrypted using the chosen algorithm and keys.\"}]\n"])</script><script>self.__next_f.push([1,"31:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"operation-principles-of-tls\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#operation-principles-of-tls\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Operation Principles of TLS\"]}]\n"])</script><script>self.__next_f.push([1,"32:[\"$\",\"p\",null,{\"children\":\"Transport Layer Security (TLS) is a cryptographic protocol designed to provide security for communication over computer networks. Its primary goal is to provide security, including privacy (confidentiality), integrity, and authenticity, for two or more communicating computer applications over a network using cryptography, such as certificates. TLS consists of two sub-layers: the TLS Record Protocol and the TLS Handshake Protocol.\"}]\n"])</script><script>self.__next_f.push([1,"33:[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"handshake-process\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#handshake-process\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Handshake Process\"]}]\n"])</script><script>self.__next_f.push([1,"34:[\"$\",\"p\",null,{\"children\":\"When a client connects to a TLS-enabled server and requests a secure connection, the handshake process begins. The handshake allows the client and server to establish security parameters for the connection using asymmetric cryptography. The complete process is as follows:\"}]\n"])</script><script>self.__next_f.push([1,"35:[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Initial Handshake\"}],\": The client connects to the TLS-enabled server, requests a secure connection, and provides a list of supported cipher suites (encryption algorithms and hash functions).\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Selecting Cipher Suite\"}],\": From the provided list, the server chooses a cipher suite and hash function it also supports and notifies the client of the decision.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Providing Digital Certificate\"}],\": Usually, the server then provides identity authentication in the form of a digital certificate. This certificate includes the server's name, trusted certificate authorities (guaranteeing the certificate's authenticity), and the server's public encryption key.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Certificate Verification\"}],\": The client verifies the certificate's validity before proceeding.\"]}],[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Generating Session Key\"}],\": To create a session key for a secure connection, the client has two methods:\",[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"Encrypt a random number (PreMasterSecret) with the server's public key and send the result to the server (only the server can decrypt it with its private key); both parties then use this random number to generate a unique session key for encrypting and decrypting data during the session.\"}],[\"$\",\"li\",null,{\"children\":\"Use Diffie-Hellman key exchange (or its variant, Elliptic Curve DH) to securely generate a random and unique session key for encryption and decryption. This key has the additional property of forward secrecy: even if the server's private key is exposed in the future, it can't be used to decrypt the current session, even if a third party intercepts and records the session.\"}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"36:[\"$\",\"p\",null,{\"children\":\"Once these steps are successfully completed, the handshake process concludes, and the encrypted connection begins. This connection uses the session key for encryption and decryption until the connection is closed. If any of the above steps fail, the TLS handshake fails, and the connection won't be established.\"}]\n"])</script><script>self.__next_f.push([1,"37:[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"tls-in-the-osi-model\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#tls-in-the-osi-model\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"TLS in the OSI Model\"]}]\n"])</script><script>self.__next_f.push([1,"38:[\"$\",\"p\",null,{\"children\":\"TLS and SSL don't perfectly align with any single layer of the OSI model or the TCP/IP model. TLS \\\"runs over some reliable transport protocol (such as TCP),\\\" which means it sits above the transport layer. It provides encryption for higher layers, typically the presentation layer. However, applications using TLS often consider it the transport layer, even though applications using TLS must actively control the initiation of TLS handshakes and the handling of exchanged authentication certificates.\"}]\n"])</script><script>self.__next_f.push([1,"39:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"ebpf-and-uprobes\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#ebpf-and-uprobes\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"eBPF and uprobes\"]}]\n"])</script><script>self.__next_f.push([1,"3a:[\"$\",\"p\",null,{\"children\":\"eBPF (Extended Berkeley Packet Filter): It's a kernel technology that allows users to run predefined programs in the kernel space without modifying kernel source code or reloading modules. It creates a bridge that enables interaction between user space and kernel space, providing unprecedented capabilities for tasks like system monitoring, performance analysis, and network traffic analysis.\"}]\n3b:[\"$\",\"p\",null,{\"children\":\"uprobes are a significant feature of eBPF, allowing dynamic insertion of probe points in user space applications, particularly useful for tracking function calls in SSL/TLS libraries.\"}]\n"])</script><script>self.__next_f.push([1,"3c:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"user-space-libraries\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#user-space-libraries\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"User-Space Libraries\"]}]\n"])</script><script>self.__next_f.push([1,"3d:[\"$\",\"p\",null,{\"children\":\"The implementation of the SSL/TLS protocol heavily relies on user-space libraries. Here are some common ones:\"}]\n3e:[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"OpenSSL: An open-source, feature-rich cryptographic library widely used in many open-source and commercial projects.\"}],[\"$\",\"li\",null,{\"children\":\"BoringSSL: A fork of OpenSSL maintained by Google, focusing on simplification and optimization for Google's needs.\"}],[\"$\",\"li\",null,{\"children\":\"GnuTLS: Part of the GNU project, offering an implementation of SSL, TLS, and DTLS protocols. GnuTLS differs from OpenSSL and BoringSSL in API design, module structure, and licensing.\"}]]}]\n"])</script><script>self.__next_f.push([1,"3f:[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"openssl-api-analysis\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#openssl-api-analysis\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"OpenSSL API Analysis\"]}]\n"])</script><script>self.__next_f.push([1,"40:[\"$\",\"p\",null,{\"children\":\"OpenSSL is a widely used open-source library providing a complete implementation of the SSL and TLS protocols, ensuring data transmission security in various applications. Among its functions, SSL_read() and SSL_write() are two core API functions for reading from and writing to TLS/SSL connections. In this section, we'll delve into these functions to help you understand their mechanisms.\"}]\n"])</script><script>self.__next_f.push([1,"41:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"1-ssl_read-function\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#1-ssl_read-function\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"1. SSL_read Function\"]}]\n"])</script><script>self.__next_f.push([1,"42:[\"$\",\"p\",null,{\"children\":[\"When we want to read data from an established SSL connection, we can use the \",[\"$\",\"code\",null,{\"children\":\"SSL_read\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"SSL_read_ex\"}],\" function. The function prototype is as follows:\"]}]\n"])</script><script>self.__next_f.push([1,"43:[\"$\",\"$L96\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-c code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SSL_read_ex\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"SSL \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"ssl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"void\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"buf\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"size_t\"}],\" num\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"size_t\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"readbytes\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SSL_read\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"SSL \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"ssl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"void\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"buf\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" num\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"44:[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"SSL_read\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"SSL_read_ex\"}],\" attempt to read up to \",[\"$\",\"code\",null,{\"children\":\"num\"}],\" bytes of data from the specified \",[\"$\",\"code\",null,{\"children\":\"ssl\"}],\" into the buffer \",[\"$\",\"code\",null,{\"children\":\"buf\"}],\". Upon success, \",[\"$\",\"code\",null,{\"children\":\"SSL_read_ex\"}],\" stores the actual number of read bytes in \",[\"$\",\"code\",null,{\"children\":\"*readbytes\"}],\".\"]}]\n"])</script><script>self.__next_f.push([1,"45:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"2-function-ssl_write\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#2-function-ssl_write\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"2. Function SSL_write\"]}]\n"])</script><script>self.__next_f.push([1,"46:[\"$\",\"p\",null,{\"children\":[\"When we want to write data into an established SSL connection, we can use the \",[\"$\",\"code\",null,{\"children\":\"SSL_write\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"SSL_write_ex\"}],\" functions.\"]}]\n47:[\"$\",\"p\",null,{\"children\":\"Function prototype:\"}]\n"])</script><script>self.__next_f.push([1,"48:[\"$\",\"$L96\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-c code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SSL_write_ex\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"SSL \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"s\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"void\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"buf\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"size_t\"}],\" num\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"size_t\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"written\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SSL_write\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"SSL \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"ssl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"void\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"buf\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" num\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"49:[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"SSL_write\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"SSL_write_ex\"}],\" will write up to \",[\"$\",\"code\",null,{\"children\":\"num\"}],\" bytes of data from the buffer \",[\"$\",\"code\",null,{\"children\":\"buf\"}],\" into the specified \",[\"$\",\"code\",null,{\"children\":\"ssl\"}],\" connection. Upon success, \",[\"$\",\"code\",null,{\"children\":\"SSL_write_ex\"}],\" will store the actual number of written bytes in \",[\"$\",\"code\",null,{\"children\":\"*written\"}],\".\"]}]\n"])</script><script>self.__next_f.push([1,"4a:[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"writing-ebpf-kernel-code\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#writing-ebpf-kernel-code\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Writing eBPF Kernel Code\"]}]\n"])</script><script>self.__next_f.push([1,"4b:[\"$\",\"p\",null,{\"children\":[\"In our example, we use eBPF to hook the \",[\"$\",\"code\",null,{\"children\":\"ssl_read\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"ssl_write\"}],\" functions to perform custom actions when data is read from or written to an SSL connection.\"]}]\n"])</script><script>self.__next_f.push([1,"4c:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"data-structures\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#data-structures\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Data Structures\"]}]\n"])</script><script>self.__next_f.push([1,"4d:[\"$\",\"p\",null,{\"children\":[\"Firstly, we define a data structure \",[\"$\",\"code\",null,{\"children\":\"probe_SSL_data_t\"}],\" to transfer data between kernel and user space:\"]}]\n"])</script><script>self.__next_f.push([1,"4e:[\"$\",\"$L96\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-c code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token macro property\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token directive-hash\",\"children\":\"#\"}],[\"$\",\"span\",null,{\"className\":\"token keyword directive\",\"children\":\"define\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token macro-name\",\"children\":\"MAX_BUF_SIZE\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token expression\",\"children\":[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"8192\"}]}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token macro property\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token directive-hash\",\"children\":\"#\"}],[\"$\",\"span\",null,{\"className\":\"token keyword directive\",\"children\":\"define\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token macro-name\",\"children\":\"TASK_COMM_LEN\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token expression\",\"children\":[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"16\"}]}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"probe_SSL_data_t\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    __u64 timestamp_ns\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Timestamp (nanoseconds)\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    __u64 delta_ns\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"      \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Function execution time\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    __u32 pid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"           \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Process ID\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    __u32 tid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"           \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Thread ID\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    __u32 uid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"           \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// User ID\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    __u32 len\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"           \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Length of read/write data\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" buf_filled\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"      \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Whether buffer is filled completely\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" rw\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"              \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Read or Write (0 for read, 1 for write)\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"char\"}],\" comm\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"TASK_COMM_LEN\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Process name\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    __u8 buf\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"MAX_BUF_SIZE\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Data buffer\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" is_handshake\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Whether it's handshake data\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$L97\",\"$L98\",\"\\n\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"4f:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"hook-functions\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#hook-functions\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Hook Functions\"]}]\n"])</script><script>self.__next_f.push([1,"50:[\"$\",\"p\",null,{\"children\":[\"Our goal is to hook into the \",[\"$\",\"code\",null,{\"children\":\"SSL_read\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"SSL_write\"}],\" functions. We define a function \",[\"$\",\"code\",null,{\"children\":\"SSL_exit\"}],\" to handle the return values of these two functions. This function determines whether to trace and collect data based on the current process and thread IDs.\"]}]\n"])</script><script>self.__next_f.push([1,"51:[\"$\",\"$L96\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-c code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"static\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SSL_exit\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"pt_regs\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" rw\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" ret \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u32 zero \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u64 pid_tgid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_get_current_pid_tgid\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u32 pid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" pid_tgid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"32\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u32 tid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"u32\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"pid_tgid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u32 uid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_get_current_uid_gid\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u64 ts \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_ktime_get_ns\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"trace_allowed\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"uid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" pid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"/* store arg info for later lookup */\"}],\"\\n\"]}],\"$L99\",\"$L9a\",\"$L9b\",\"$L9c\",\"$L9d\",\"$L9e\",\"$L9f\",\"$La0\",\"$La1\",\"$La2\",\"$La3\",\"$La4\",\"$La5\",\"$La6\",\"$La7\",\"$La8\",\"$La9\",\"$Laa\",\"$Lab\",\"$Lac\",\"$Lad\",\"$Lae\",\"$Laf\",\"$Lb0\",\"$Lb1\",\"$Lb2\",\"$Lb3\",\"$Lb4\",\"$Lb5\",\"$Lb6\",\"$Lb7\",\"$Lb8\",\"$Lb9\",\"$Lba\",\"$Lbb\",\"$Lbc\",\"$Lbd\",\"$Lbe\",\"$Lbf\",\"$Lc0\",\"$Lc1\",\"$Lc2\",\"$Lc3\",\"$Lc4\",\"$Lc5\"]}]}]\n"])</script><script>self.__next_f.push([1,"52:[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"rw\"}],\" parameter here indicates whether it's a read or write operation. 0 represents read, and 1 represents write.\"]}]\n"])</script><script>self.__next_f.push([1,"53:[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"data-collection-process\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#data-collection-process\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Data Collection Process\"]}]\n"])</script><script>self.__next_f.push([1,"54:[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":\"Obtain the ID of the current process and thread, along with the ID of the current user.\"}],[\"$\",\"li\",null,{\"children\":[\"Use \",[\"$\",\"code\",null,{\"children\":\"trace_allowed\"}],\" to determine if tracing is allowed for this process.\"]}],[\"$\",\"li\",null,{\"children\":\"Get the start time to calculate the execution time of the function.\"}],[\"$\",\"li\",null,{\"children\":[\"Attempt to retrieve relevant data from the \",[\"$\",\"code\",null,{\"children\":\"bufs\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"start_ns\"}],\" maps.\"]}],[\"$\",\"li\",null,{\"children\":[\"If data retrieval is successful, create or locate a \",[\"$\",\"code\",null,{\"children\":\"probe_SSL_data_t\"}],\" structure to populate the data.\"]}],[\"$\",\"li\",null,{\"children\":\"Copy the data from user space to the buffer, ensuring it doesn't exceed the designated size.\"}],[\"$\",\"li\",null,{\"children\":\"Finally, send the data to user space.\"}]]}]\n"])</script><script>self.__next_f.push([1,"55:[\"$\",\"p\",null,{\"children\":[\"Note: We use two user-level return probes \",[\"$\",\"code\",null,{\"children\":\"uretprobe\"}],\" to respectively hook the returns of \",[\"$\",\"code\",null,{\"children\":\"SSL_read\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"SSL_write\"}],\":\"]}]\n"])</script><script>self.__next_f.push([1,"56:[\"$\",\"$L96\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-c code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SEC\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"uretprobe/SSL_read\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"BPF_URETPROBE\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"probe_SSL_read_exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SSL_exit\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 0 indicates read operation\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SEC\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"uretprobe/SSL_write\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"BPF_URETPROBE\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"probe_SSL_write_exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SSL_exit\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 1 indicates write operation\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"57:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"hooking-into-the-handshake-process\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#hooking-into-the-handshake-process\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Hooking into the Handshake Process\"]}]\n"])</script><script>self.__next_f.push([1,"58:[\"$\",\"p\",null,{\"children\":[\"In SSL/TLS, the handshake is a special process used to establish a secure connection between a client and a server. To analyze this process, we hook into the \",[\"$\",\"code\",null,{\"children\":\"do_handshake\"}],\" function to track the start and end of the handshake.\"]}]\n"])</script><script>self.__next_f.push([1,"59:[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"entering-the-handshake\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#entering-the-handshake\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Entering the Handshake\"]}]\n"])</script><script>self.__next_f.push([1,"5a:[\"$\",\"p\",null,{\"children\":[\"We use a \",[\"$\",\"code\",null,{\"children\":\"uprobe\"}],\" to set a probe for the \",[\"$\",\"code\",null,{\"children\":\"do_handshake\"}],\" function:\"]}]\n"])</script><script>self.__next_f.push([1,"5b:[\"$\",\"$L96\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-c code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SEC\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"uprobe/do_handshake\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"BPF_UPROBE\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"probe_SSL_do_handshake_enter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"void\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"ssl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u64 pid_tgid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_get_current_pid_tgid\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u32 pid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" pid_tgid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"32\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u32 tid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"u32\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"pid_tgid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u64 ts \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_ktime_get_ns\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u32 uid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_get_current_uid_gid\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"trace_allowed\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"uid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" pid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"/* store arg info for later lookup */\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_map_update_elem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"start_ns\",\"$Lc6\",\" \",\"$Lc7\",\"tid\",\"$Lc8\",\" \",\"$Lc9\",\"ts\",\"$Lca\",\" BPF_ANY\",\"$Lcb\",\"$Lcc\",\"\\n\"]}],\"$Lcd\",\"$Lce\"]}]}]\n"])</script><script>self.__next_f.push([1,"5c:[\"$\",\"p\",null,{\"children\":\"The main functionality of this code is as follows:\"}]\n5d:[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"Obtain the current \",[\"$\",\"code\",null,{\"children\":\"pid\"}],\", \",[\"$\",\"code\",null,{\"children\":\"tid\"}],\", \",[\"$\",\"code\",null,{\"children\":\"ts\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"uid\"}],\".\"]}],[\"$\",\"li\",null,{\"children\":[\"Use \",[\"$\",\"code\",null,{\"children\":\"trace_allowed\"}],\" to verify if the process is allowed to be traced.\"]}],[\"$\",\"li\",null,{\"children\":[\"Store the current timestamp in the \",[\"$\",\"code\",null,{\"children\":\"start_ns\"}],\" map, which will be used to calculate the duration of the handshake process later.\"]}]]}]\n"])</script><script>self.__next_f.push([1,"5e:[\"$\",\"h4\",null,{\"className\":\"content-header\",\"id\":\"exiting-the-handshake\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#exiting-the-handshake\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Exiting the Handshake\"]}]\n"])</script><script>self.__next_f.push([1,"5f:[\"$\",\"p\",null,{\"children\":[\"Similarly, we've set a \",[\"$\",\"code\",null,{\"children\":\"uretprobe\"}],\" for the return of \",[\"$\",\"code\",null,{\"children\":\"do_handshake\"}],\":\"]}]\n"])</script><script>self.__next_f.push([1,"60:[\"$\",\"$L96\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-c code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SEC\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"uretprobe/do_handshake\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"BPF_URETPROBE\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"handle_do_handshake_exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Code to execute upon exiting the do_handshake function.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"61:[\"$\",\"p\",null,{\"children\":[\"In this context, the \",[\"$\",\"code\",null,{\"children\":\"uretprobe\"}],\" will execute the provided code when the \",[\"$\",\"code\",null,{\"children\":\"do_handshake\"}],\" function exits.\"]}]\n"])</script><script>self.__next_f.push([1,"62:[\"$\",\"$L96\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-c code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"SEC\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"uretprobe/do_handshake\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"BPF_URETPROBE\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"probe_SSL_do_handshake_exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u32 zero \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u64 pid_tgid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_get_current_pid_tgid\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u32 pid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" pid_tgid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"32\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u32 tid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"u32\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"pid_tgid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u32 uid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_get_current_uid_gid\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u64 ts \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_ktime_get_ns\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" ret \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"/* use kernel terminology here for tgid/pid: */\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u32 tgid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" pid_tgid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"32\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"/* store arg info for later lookup */\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"trace_allowed\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"tgid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" pid\",\"$Lcf\",\"$Ld0\",\" \",\"$Ld1\",\"\\n\"]}],\"$Ld2\",\"$Ld3\",\"$Ld4\",\"$Ld5\",\"$Ld6\",\"$Ld7\",\"$Ld8\",\"$Ld9\",\"$Lda\",\"$Ldb\",\"$Ldc\",\"$Ldd\",\"$Lde\",\"$Ldf\",\"$Le0\",\"$Le1\",\"$Le2\",\"$Le3\",\"$Le4\",\"$Le5\",\"$Le6\",\"$Le7\",\"$Le8\",\"$Le9\",\"$Lea\",\"$Leb\",\"$Lec\",\"$Led\",\"$Lee\",\"$Lef\",\"$Lf0\"]}]}]\n"])</script><script>self.__next_f.push([1,"63:[\"$\",\"p\",null,{\"children\":\"Logic of this Function:\"}]\n"])</script><script>self.__next_f.push([1,"64:[\"$\",\"ol\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"Obtain the current \",[\"$\",\"code\",null,{\"children\":\"pid\"}],\", \",[\"$\",\"code\",null,{\"children\":\"tid\"}],\", \",[\"$\",\"code\",null,{\"children\":\"ts\"}],\", and \",[\"$\",\"code\",null,{\"children\":\"uid\"}],\".\"]}],[\"$\",\"li\",null,{\"children\":[\"Use \",[\"$\",\"code\",null,{\"children\":\"trace_allowed\"}],\" to recheck if tracing is allowed.\"]}],[\"$\",\"li\",null,{\"children\":[\"Look up the timestamp in the \",[\"$\",\"code\",null,{\"children\":\"start_ns\"}],\" map for calculating handshake duration.\"]}],[\"$\",\"li\",null,{\"children\":[\"Use \",[\"$\",\"code\",null,{\"children\":\"PT_REGS_RC(ctx)\"}],\" to get the return value of \",[\"$\",\"code\",null,{\"children\":\"do_handshake\"}],\" and determine if the handshake was successful.\"]}],[\"$\",\"li\",null,{\"children\":[\"Find or initialize the \",[\"$\",\"code\",null,{\"children\":\"probe_SSL_data_t\"}],\" data structure associated with the current thread.\"]}],[\"$\",\"li\",null,{\"children\":\"Update the data structure's fields, including timestamp, duration, process information, etc.\"}],[\"$\",\"li\",null,{\"children\":[\"Use \",[\"$\",\"code\",null,{\"children\":\"bpf_perf_event_output\"}],\" to send the data to user space.\"]}]]}]\n"])</script><script>self.__next_f.push([1,"65:[\"$\",\"p\",null,{\"children\":[\"Our eBPF code not only tracks data transmission for \",[\"$\",\"code\",null,{\"children\":\"ssl_read\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"ssl_write\"}],\" but also focuses on the SSL/TLS handshake process. This information is crucial for a deeper understanding and optimization of the performance of secure connections.\"]}]\n66:[\"$\",\"p\",null,{\"children\":\"Through these hook functions, we can obtain data regarding the success of the handshake, the time taken for the handshake, and related process information. This provides us with insights into the behavior of the system's SSL/TLS, enabling us to perform more in-depth analysis and optimization when necessary.\"}]\n"])</script><script>self.__next_f.push([1,"67:[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"user-space-assisted-code-analysis-and-interpretation\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#user-space-assisted-code-analysis-and-interpretation\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"User-Space Assisted Code Analysis and Interpretation\"]}]\n"])</script><script>self.__next_f.push([1,"68:[\"$\",\"p\",null,{\"children\":\"In the eBPF ecosystem, user-space and kernel-space code often work in collaboration. Kernel-space code is responsible for data collection, while user-space code manages, processes, and handles this data. In this section, we will explain how the above user-space code collaborates with eBPF to trace SSL/TLS interactions.\"}]\n"])</script><script>self.__next_f.push([1,"69:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"1-supported-library-attachment\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#1-supported-library-attachment\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"1. Supported Library Attachment\"]}]\n"])</script><script>self.__next_f.push([1,"6a:[\"$\",\"p\",null,{\"children\":[\"In the provided code snippet, based on the setting of the \",[\"$\",\"code\",null,{\"children\":\"env\"}],\" environment variable, the program can choose to attach to three common encryption libraries (OpenSSL, GnuTLS, and NSS). This means that we can trace calls to multiple libraries within the same tool.\"]}]\n6b:[\"$\",\"p\",null,{\"children\":[\"To achieve this functionality, the \",[\"$\",\"code\",null,{\"children\":\"find_library_path\"}],\" function is first used to determine the library's path. Then, depending on the library type, the corresponding \",[\"$\",\"code\",null,{\"children\":\"attach_\"}],\" function is called to attach the eBPF program to the library function.\"]}]\n"])</script><script>self.__next_f.push([1,"6c:[\"$\",\"$L96\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-c code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"env\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"openssl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"char\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"openssl_path \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"find_library_path\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"libssl.so\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"printf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"OpenSSL path: %s\\\\n\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" openssl_path\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"attach_openssl\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"obj\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"/lib/x86_64-linux-gnu/libssl.so.3\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"env\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"gnutls\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"char\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"gnutls_path \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"find_library_path\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"libgnutls.so\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"printf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"GnuTLS path: %s\\\\n\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" gnutls_path\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"attach_gnutls\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"obj\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" gnutls_path\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"env\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"nss\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",\"$Lf1\",\"\\n\"]}],\"$Lf2\",\"$Lf3\",\"$Lf4\",\"$Lf5\"]}]}]\n"])</script><script>self.__next_f.push([1,"6d:[\"$\",\"p\",null,{\"children\":\"This section primarily covers the attachment logic for the OpenSSL, GnuTLS, and NSS libraries. NSS is a set of security libraries designed for organizations, supporting the creation of secure client and server applications. Originally developed by Netscape, they are now maintained by Mozilla. The other two libraries have been introduced earlier and are not reiterated here.\"}]\n"])</script><script>self.__next_f.push([1,"6e:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"2-detailed-attachment-logic\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#2-detailed-attachment-logic\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"2. Detailed Attachment Logic\"]}]\n"])</script><script>self.__next_f.push([1,"6f:[\"$\",\"p\",null,{\"children\":[\"The specific \",[\"$\",\"code\",null,{\"children\":\"attach\"}],\" functions are as follows:\"]}]\n"])</script><script>self.__next_f.push([1,"70:[\"$\",\"$L96\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-c code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token macro property\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token directive-hash\",\"children\":\"#\"}],[\"$\",\"span\",null,{\"className\":\"token keyword directive\",\"children\":\"define\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function macro-name\",\"children\":\"__ATTACH_UPROBE\"}],[\"$\",\"span\",null,{\"className\":\"token expression\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" binary_path\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" sym_name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" prog_name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" is_retprobe\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"   \"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\\\\\"}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token macro property\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token expression\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"do\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"                                                                       \"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\\\\\"}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token macro property\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token expression\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"LIBBPF_OPTS\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"bpf_uprobe_opts\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" uprobe_opts\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"func_name \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" #sym_name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"        \"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\\\\\"}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token macro property\",\"children\":[\"                  \",[\"$\",\"span\",null,{\"className\":\"token expression\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"retprobe \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" is_retprobe\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"                                    \"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\\\\\"}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token macro property\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token expression\",\"children\":[\"skel\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"links\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"prog_name \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_program__attach_uprobe_opts\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"                 \"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\\\\\"}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token macro property\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token expression\",\"children\":[\"skel\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"progs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"prog_name\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" env\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"pid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" binary_path\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"uprobe_opts\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"       \"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\\\\\"}],\"\\n\"]}]}],\"$Lf6\",\"$Lf7\",\"$Lf8\",\"$Lf9\",\"$Lfa\",\"$Lfb\",\"$Lfc\",\"$Lfd\",\"$Lfe\",\"$Lff\",\"$L100\",\"$L101\",\"$L102\",\"$L103\",\"$L104\",\"$L105\",\"$L106\",\"$L107\",\"$L108\",\"$L109\",\"$L10a\",\"$L10b\",\"$L10c\",\"$L10d\",\"$L10e\",\"$L10f\",\"$L110\",\"$L111\",\"$L112\",\"$L113\",\"$L114\",\"$L115\",\"$L116\",\"$L117\",\"$L118\",\"$L119\",\"$L11a\",\"$L11b\",\"$L11c\"]}]}]\n"])</script><script>self.__next_f.push([1,"71:[\"$\",\"p\",null,{\"children\":[\"We further examine the \",[\"$\",\"code\",null,{\"children\":\"attach_\"}],\" function and can see that they both use the \",[\"$\",\"code\",null,{\"children\":\"ATTACH_UPROBE_CHECKED\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"ATTACH_URETPROBE_CHECKED\"}],\" macros to implement specific mounting logic. These two macros are used respectively for setting uprobe (function entry) and uretprobe (function return).\"]}]\n72:[\"$\",\"p\",null,{\"children\":[\"Considering that different libraries have different API function names (for example, OpenSSL uses \",[\"$\",\"code\",null,{\"children\":\"SSL_write\"}],\", while GnuTLS uses \",[\"$\",\"code\",null,{\"children\":\"gnutls_record_send\"}],\"), we need to write a separate \",[\"$\",\"code\",null,{\"children\":\"attach_\"}],\" function for each library.\"]}]\n73:[\"$\",\"p\",null,{\"children\":[\"For instance, in the \",[\"$\",\"code\",null,{\"children\":\"attach_openssl\"}],\" function, we set up probes for both \",[\"$\",\"code\",null,{\"children\":\"SSL_write\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"SSL_read\"}],\". If users also want to track handshake latency (\",[\"$\",\"code\",null,{\"children\":\"env.latency\"}],\") and the handshake process (\",[\"$\",\"code\",null,{\"children\":\"env.handshake\"}],\"), we set up a probe for \",[\"$\",\"code\",null,{\"children\":\"SSL_do_handshake\"}],\".\"]}]\n74:[\"$\",\"p\",null,{\"children\":[\"In the eBPF ecosystem, \",[\"$\",\"code\",null,{\"children\":\"perf_buffer\"}],\" is an efficient mechanism used to transfer data from kernel space to user space. This is particularly useful for kernel-space eBPF programs as they can't directly interact with user space. With \",[\"$\",\"code\",null,{\"children\":\"perf_buffer\"}],\", we can collect data in kernel-space eBPF programs and then asynchronously read this data in user space. We use the \",[\"$\",\"code\",null,{\"children\":\"perf_buffer__poll\"}],\" function to read data reported in kernel space, as shown below:\"]}]\n"])</script><script>self.__next_f.push([1,"75:[\"$\",\"$L96\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-c code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"while\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"exiting\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"perf_buffer__poll\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"pb\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" PERF_POLL_TIMEOUT_MS\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\u0026\"}],\" err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"EINTR\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"warn\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"error polling perf buffer: %s\\\\n\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"strerror\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\"err\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"goto\"}],\" cleanup\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    err \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"76:[\"$\",\"p\",null,{\"children\":[\"Finally, in the \",[\"$\",\"code\",null,{\"children\":\"print_event\"}],\" function, we print the data to standard output:\"]}]\n"])</script><script>self.__next_f.push([1,"77:[\"$\",\"$L96\",null,{\"className\":\"language-c\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-c code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// Function to print the event from the perf buffer\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"void\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"print_event\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"probe_SSL_data_t\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"event\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"char\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"evt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"buf_size \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"env\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"hexdump\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 2 characters for each byte + null terminator\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"char\"}],\" hex_data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"MAX_BUF_SIZE \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"  \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"buf_to_hex\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"uint8_t\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"buf\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" buf_size\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" hex_data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"            \\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"printf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\\n%s\\\\n\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" s_mark\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],\"$L11d\",\"$L11e\",\"$L11f\",\"$L120\",\"$L121\",\"$L122\",\"$L123\",\"$L124\",\"$L125\"]}]}]\n"])</script><script>self.__next_f.push([1,"78:[\"$\",\"p\",null,{\"children\":[\"You can find the complete source code here: \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/eunomia-bpf/bpf-developer-tutorial/tree/main/src/30-sslsniff\",\"children\":\"https://github.com/eunomia-bpf/bpf-developer-tutorial/tree/main/src/30-sslsniff\"}]]}]\n"])</script><script>self.__next_f.push([1,"79:[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"compilation-and-execution\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#compilation-and-execution\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Compilation and Execution\"]}]\n"])</script><script>self.__next_f.push([1,"7a:[\"$\",\"p\",null,{\"children\":[\"To start using \",[\"$\",\"code\",null,{\"children\":\"sslsniff\"}],\", you need to first compile it:\"]}]\n7b:[\"$\",\"$L96\",null,{\"className\":\"language-sh\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-sh\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"make\"}],\"\\n\"]}]}]}]\n7c:[\"$\",\"p\",null,{\"children\":\"Once done, follow these steps:\"}]\n"])</script><script>self.__next_f.push([1,"7d:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"start-sslsniff\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#start-sslsniff\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],[\"$\",\"strong\",null,{\"children\":\"Start sslsniff\"}]]}]\n"])</script><script>self.__next_f.push([1,"7e:[\"$\",\"p\",null,{\"children\":[\"In a terminal, execute the following command to start \",[\"$\",\"code\",null,{\"children\":\"sslsniff\"}],\":\"]}]\n7f:[\"$\",\"$L96\",null,{\"className\":\"language-sh\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-sh\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"sudo\"}],\" ./sslsniff\\n\"]}]}]}]\n"])</script><script>self.__next_f.push([1,"80:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"execute-curl-command\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#execute-curl-command\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],[\"$\",\"strong\",null,{\"children\":\"Execute CURL command\"}]]}]\n"])</script><script>self.__next_f.push([1,"81:[\"$\",\"p\",null,{\"children\":\"In another terminal, execute:\"}]\n82:[\"$\",\"$L96\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-console\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"curl https://example.com\\n\"}]}]}]\n83:[\"$\",\"p\",null,{\"children\":\"Under normal circumstances, you will see output similar to the following:\"}]\n"])</script><script>self.__next_f.push([1,"84:[\"$\",\"$L96\",null,{\"className\":\"language-html\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-html\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token doctype\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c!\"}],[\"$\",\"span\",null,{\"className\":\"token doctype-tag\",\"children\":\"doctype\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token name\",\"children\":\"html\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c\"}],\"html\"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c\"}],\"head\"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c\"}],\"title\"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003e\"}]]}],\"Example Domain\",[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c/\"}],\"title\"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"        ...\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c\"}],\"body\"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c\"}],\"div\"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"        ...\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c/\"}],\"div\"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c/\"}],\"body\"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c/\"}],\"html\"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003e\"}]]}],\"\\n\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"85:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"sslsniff-output\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#sslsniff-output\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],[\"$\",\"strong\",null,{\"children\":\"sslsniff Output\"}]]}]\n"])</script><script>self.__next_f.push([1,"86:[\"$\",\"p\",null,{\"children\":[\"After executing the \",[\"$\",\"code\",null,{\"children\":\"curl\"}],\" command, \",[\"$\",\"code\",null,{\"children\":\"sslsniff\"}],\" will display the following content:\"]}]\n"])</script><script>self.__next_f.push([1,"87:[\"$\",\"$L96\",null,{\"className\":\"language-txt\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-txt\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    READ/RECV    0.132786160        curl             47458   1256  \\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    ----- DATA -----\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    \u003c!doctype html\u003e\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    ...\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    \u003cdiv\u003e\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"        \u003ch1\u003eExample Domain\u003c/h1\u003e\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"        ...\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    \u003c/div\u003e\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    \u003c/body\u003e\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    \u003c/html\u003e\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    ----- END DATA -----\\n\"}]]}]}]\n"])</script><script>self.__next_f.push([1,"88:[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Note\"}],\": The displayed HTML content may vary depending on the specific content of the \",[\"$\",\"code\",null,{\"children\":\"example.com\"}],\" page.\"]}]\n"])</script><script>self.__next_f.push([1,"89:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"displaying-latency-and-handshake-process\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#displaying-latency-and-handshake-process\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Displaying Latency and Handshake Process\"]}]\n"])</script><script>self.__next_f.push([1,"8a:[\"$\",\"p\",null,{\"children\":\"To view latency and handshake process, execute the following command:\"}]\n"])</script><script>self.__next_f.push([1,"8b:[\"$\",\"$L96\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-console\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"$$ sudo ./sslsniff -l --handshake\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"OpenSSL path: /lib/x86_64-linux-gnu/libssl.so.3\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"GnuTLS path: /lib/x86_64-linux-gnu/libgnutls.so.30\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"NSS path: /lib/x86_64-linux-gnu/libnspr4.so\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"FUNC         TIME(s)            COMM             PID     LEN     LAT(ms)\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"HANDSHAKE    0.000000000        curl             6460    1      1.384  WRITE/SEND   0.000115400        curl             6460    24     0.014 \\n\"}]]}]}]\n"])</script><script>self.__next_f.push([1,"8c:[\"$\",\"h3\",null,{\"className\":\"content-header\",\"id\":\"hexadecimal-output\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#hexadecimal-output\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Hexadecimal Output\"]}]\n"])</script><script>self.__next_f.push([1,"8d:[\"$\",\"p\",null,{\"children\":\"To display data in hexadecimal format, execute the following command:\"}]\n"])</script><script>self.__next_f.push([1,"8e:[\"$\",\"$L96\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight language-console\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"$$ sudo ./sslsniff --hexdump\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"WRITE/SEND   0.000000000        curl             16104   24    \\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"----- DATA -----\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"505249202a20485454502f322e300d0a\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"0d0a534d0d0a0d0a\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"----- END DATA -----\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"...\\n\"}]]}]}]\n"])</script><script>self.__next_f.push([1,"8f:[\"$\",\"h2\",null,{\"className\":\"content-header\",\"id\":\"summary\",\"children\":[[\"$\",\"a\",null,{\"className\":\"break-words\",\"href\":\"#summary\",\"aria-hidden\":\"true\",\"tabIndex\":\"-1\",\"children\":[\"$\",\"span\",null,{\"className\":\"content-header-link\",\"children\":[\"$\",\"svg\",null,{\"className\":\"h-5 linkicon w-5\",\"fill\":\"currentColor\",\"viewBox\":\"0 0 20 20\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\"}],[\"$\",\"path\",null,{\"d\":\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\"}]]}]}]}],\"Summary\"]}]\n"])</script><script>self.__next_f.push([1,"90:[\"$\",\"p\",null,{\"children\":[\"eBPF is a very powerful technology that can help us gain deeper insights into how a system works. This tutorial is a simple example demonstrating how to use eBPF to monitor SSL/TLS communication. If you're interested in eBPF technology and want to learn more and practice further, you can visit our tutorial code repository at \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/eunomia-bpf/bpf-developer-tutorial\",\"children\":\"https://github.com/eunomia-bpf/bpf-developer-tutorial\"}],\" and tutorial website at \",[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://eunomia.dev/zh/tutorials/\",\"children\":\"https://eunomia.dev/zh/tutorials/\"}],\".\"]}]\n"])</script><script>self.__next_f.push([1,"91:[\"$\",\"p\",null,{\"children\":\"References:\"}]\n"])</script><script>self.__next_f.push([1,"92:[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/iovisor/bcc/pull/4706\",\"children\":\"https://github.com/iovisor/bcc/pull/4706\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/openssl/openssl\",\"children\":\"https://github.com/openssl/openssl\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.openssl.org/docs/man1.1.1/man3/SSL_read.html\",\"children\":\"https://www.openssl.org/docs/man1.1.1/man3/SSL_read.html\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/iovisor/bcc/blob/master/tools/sslsniff_example.txt\",\"children\":\"https://github.com/iovisor/bcc/blob/master/tools/sslsniff_example.txt\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"className\":\"break-words\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://en.wikipedia.org/wiki/Transport_Layer_Security\",\"children\":\"https://en.wikipedia.org/wiki/Transport_Layer_Security\"}]}]]}]\n"])</script><script>self.__next_f.push([1,"93:[\"$\",\"div\",null,{\"className\":\"pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300 glass p-4 rounded-xl\",\"children\":[[\"$\",\"a\",null,{\"className\":\"hover:text-primary-600 dark:hover:text-primary-400 transition-colors\",\"target\":\"_blank\",\"rel\":\"nofollow\",\"href\":\"https://mobile.twitter.com/search?q=https%3A%2F%2Fwww.yunwei37.com%2Fblog%2Fssl-uprobe\",\"children\":\"Discuss on Twitter\"}],\" • \",[\"$\",\"a\",null,{\"className\":\"hover:text-primary-600 dark:hover:text-primary-400 transition-colors\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/yunwei37/yunwei37-blog/blob/main/data/blog/ssl-uprobe.mdx\",\"children\":\"View on GitHub\"}]]}]\n94:[\"$\",\"div\",null,{\"className\":\"pt-6 pb-6 text-center text-gray-700 dark:text-gray-300 glass p-6 rounded-xl\",\"id\":\"comment\",\"children\":[\"$\",\"$L126\",null,{\"slug\":\"ssl-uprobe\"}]}]\n"])</script><script>self.__next_f.push([1,"95:[\"$\",\"footer\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"divide-gray-200/30 text-sm leading-5 font-medium xl:col-start-1 xl:row-start-2 xl:divide-y dark:divide-gray-700/30\",\"children\":[[\"$\",\"div\",null,{\"className\":\"py-4 xl:py-8\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-xs tracking-wide text-gray-600 uppercase dark:text-gray-300 mb-4\",\"children\":\"Tags\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap gap-2\",\"children\":[[\"$\",\"$L6\",\"ebpf\",{\"href\":\"/tags/ebpf\",\"className\":\"inline-block px-3 py-1 text-xs font-medium uppercase tracking-wide bg-primary-100 hover:bg-primary-200 dark:bg-primary-900/30 dark:hover:bg-primary-800/40 rounded-full transition-all duration-200 text-primary-800 hover:text-primary-900 dark:text-primary-300 dark:hover:text-primary-200 border border-primary-200/50 dark:border-primary-700/50\",\"children\":\"ebpf\"}],[\"$\",\"$L6\",\"tutorial\",{\"href\":\"/tags/tutorial\",\"className\":\"inline-block px-3 py-1 text-xs font-medium uppercase tracking-wide bg-primary-100 hover:bg-primary-200 dark:bg-primary-900/30 dark:hover:bg-primary-800/40 rounded-full transition-all duration-200 text-primary-800 hover:text-primary-900 dark:text-primary-300 dark:hover:text-primary-200 border border-primary-200/50 dark:border-primary-700/50\",\"children\":\"tutorial\"}]]}]]}],[\"$\",\"div\",null,{\"className\":\"flex justify-between py-4 xl:block xl:space-y-6 xl:py-8\",\"children\":[[\"$\",\"div\",null,{\"className\":\"glass p-4 rounded-xl\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-xs tracking-wide text-gray-600 uppercase dark:text-gray-300 mb-2\",\"children\":\"Previous Article\"}],[\"$\",\"div\",null,{\"className\":\"text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 transition-colors\",\"children\":[\"$\",\"$L6\",null,{\"className\":\"break-words\",\"href\":\"/blog/ebpf-wasm\",\"children\":\"When Wasm Meets eBPF: Writing, Distributing, Loading, and Running eBPF Programs with WebAssembly\"}]}]]}],[\"$\",\"div\",null,{\"className\":\"glass p-4 rounded-xl\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-xs tracking-wide text-gray-600 uppercase dark:text-gray-300 mb-2\",\"children\":\"Next Article\"}],[\"$\",\"div\",null,{\"className\":\"text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 transition-colors\",\"children\":[\"$\",\"$L6\",null,{\"className\":\"break-words\",\"href\":\"/blog/natual-language-program\",\"children\":\"自然语言编程: 从 AutoGPT 往前迈的一小步\"}]}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"pt-4 xl:pt-8\",\"children\":[\"$\",\"$L6\",null,{\"className\":\"inline-flex items-center glass px-4 py-2 rounded-xl text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 transition-all duration-200 hover:scale-105\",\"href\":\"/blog\",\"aria-label\":\"Back to the blog\",\"children\":\"← Back to the blog\"}]}]]}]\n"])</script><script>self.__next_f.push([1,"97:[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]\n98:[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}]\n"])</script><script>self.__next_f.push([1,"99:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u64 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"bufp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_map_lookup_elem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"bufs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"tid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"9a:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"bufp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]\n9b:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n9c:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\n"])</script><script>self.__next_f.push([1,"9d:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u64 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"tsp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_map_lookup_elem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"start_ns\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"tid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"9e:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"tsp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]\n9f:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\na0:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u64 delta_ns \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" ts \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"tsp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\na1:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\na2:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" len \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"PT_REGS_RC\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\na3:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"len \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// no data\"}],\"\\n\"]}]\na4:[\"$\",\"span\",null,{"])</script><script>self.__next_f.push([1,"\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\na5:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\n"])</script><script>self.__next_f.push([1,"a6:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"probe_SSL_data_t\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"data \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_map_lookup_elem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"ssl_data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"zero\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"a7:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]\na8:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\na9:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\naa:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"timestamp_ns \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" ts\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nab:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"delta_ns \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" delta_ns\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nac:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"pid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" pid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nad:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"tid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" tid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nae:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"uid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\""])</script><script>self.__next_f.push([1,"}],\" uid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\naf:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"len \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"u32\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"len\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nb0:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"buf_filled \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nb1:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"rw \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" rw\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nb2:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"is_handshake \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" false\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"b3:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u32 buf_copy_size \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"min\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"size_t\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"MAX_BUF_SIZE\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"size_t\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"len\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"b4:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\n"])</script><script>self.__next_f.push([1,"b5:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_get_current_comm\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"comm\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"sizeof\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"comm\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"b6:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\nb7:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"bufp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"b8:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        ret \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_probe_read_user\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"buf\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" buf_copy_size\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"char\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"bufp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"b9:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\nba:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_map_delete_elem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"bufs\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"tid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nbb:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_map_delete_elem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"start_ns\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"tid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nbc:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\nbd:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"ret\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]\nbe:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"buf_filled \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nbf:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"c"])</script><script>self.__next_f.push([1,"lassName\":\"token keyword\",\"children\":\"else\"}],\"\\n\"]}]\nc0:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        buf_copy_size \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nc1:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\nc2:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_perf_event_output\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"perf_SSL_events\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" BPF_F_CURRENT_CPU\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}]\nc3:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                            \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"EVENT_SIZE\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"buf_copy_size\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nc4:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nc5:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]\nc6:[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}]\nc7:[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}]\nc8:[\"$\",\"span\",null,{\"className\":\"tok"])</script><script>self.__next_f.push([1,"en punctuation\",\"children\":\",\"}]\nc9:[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}]\nca:[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}]\ncb:[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}]\ncc:[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}]\ncd:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nce:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]\ncf:[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}]\nd0:[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}]\nd1:[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}]\nd2:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nd3:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]\nd4:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\n"])</script><script>self.__next_f.push([1,"d5:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    u64 \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"tsp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_map_lookup_elem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"start_ns\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"tid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"d6:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"tsp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"==\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]\nd7:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nd8:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\nd9:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    ret \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"PT_REGS_RC\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nda:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ret \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// handshake failed\"}],\"\\n\"]}]\ndb:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\ndc:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\n"])</script><script>self.__next_f.push([1,"dd:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"probe_SSL_data_t\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"data \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_map_lookup_elem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"ssl_data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"zero\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"de:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]\ndf:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\ne0:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\ne1:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"timestamp_ns \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" ts\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\ne2:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"delta_ns \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" ts \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"tsp\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\ne3:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"pid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" pid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\ne4:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"tid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" tid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\ne5:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\","])</script><script>self.__next_f.push([1,"[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"uid \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" uid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\ne6:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"len \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" ret\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\ne7:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"buf_filled \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\ne8:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"rw \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\ne9:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"is_handshake \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" true\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"ea:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_get_current_comm\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"comm\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"sizeof\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\u003e\"}],\"comm\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"eb:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_map_delete_elem\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"start_ns\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"tid\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nec:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\ned:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"bpf_perf_event_output\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ctx\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\"}],\"perf_SSL_events\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" BPF_F_CURRENT_CPU\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}]\nee:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                            \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"EVENT_SIZE\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nef:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nf0:[\"$\",\"span\",null,{\"classNam"])</script><script>self.__next_f.push([1,"e\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]\nf1:[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}]\nf2:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"char\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"nss_path \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"find_library_path\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"libnspr4.so\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nf3:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"printf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"NSS path: %s\\\\n\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" nss_path\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nf4:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"attach_nss\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"obj\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" nss_path\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nf5:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]\nf6:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token macro property\",\"children\":[\"    \",[\"$\",\"span\",null,{\"cl"])</script><script>self.__next_f.push([1,"assName\":\"token expression\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"while\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"false\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}]]}]]}],\"\\n\"]}]\nf7:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"    \\n\"}]\n"])</script><script>self.__next_f.push([1,"f8:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"attach_openssl\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"sslsniff_bpf\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"char\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"f9:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_UPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" SSL_write\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_rw_enter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nfa:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_URETPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" SSL_write\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_write_exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nfb:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_UPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" SSL_read\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_rw_enter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nfc:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_URETPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel"])</script><script>self.__next_f.push([1,"\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" SSL_read\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_read_exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\nfd:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\nfe:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"env\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"latency \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\u0026\"}],\" env\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"handshake\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}]\nff:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_UPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" SSL_do_handshake\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}]\n100:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                            probe_SSL_do_handshake_enter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n101:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_URETPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],"])</script><script>self.__next_f.push([1,"\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" SSL_do_handshake\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}]\n102:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                                probe_SSL_do_handshake_exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n103:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]\n104:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\n105:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n106:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]\n107:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\n"])</script><script>self.__next_f.push([1,"108:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"attach_gnutls\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"sslsniff_bpf\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"char\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"109:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_UPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" gnutls_record_send\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_rw_enter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n10a:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_URETPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" gnutls_record_send\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_write_exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n10b:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_UPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" gnutls_record_recv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_rw_enter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n10c:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_URETPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token pun"])</script><script>self.__next_f.push([1,"ctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" gnutls_record_recv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_read_exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n10d:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\n10e:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n10f:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]\n110:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\n"])</script><script>self.__next_f.push([1,"111:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"int\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"attach_nss\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"struct\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"sslsniff_bpf\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"char\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\"lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"112:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_UPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" PR_Write\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_rw_enter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n113:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_URETPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" PR_Write\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_write_exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n114:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_UPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" PR_Send\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_rw_enter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n115:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_URETPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"ske"])</script><script>self.__next_f.push([1,"l\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" PR_Send\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_write_exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n116:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_UPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" PR_Read\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_rw_enter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n117:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_URETPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" PR_Read\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_read_exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n118:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_UPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" PR_Recv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" "])</script><script>self.__next_f.push([1,"probe_SSL_rw_enter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n119:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ATTACH_URETPROBE_CHECKED\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"skel\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" lib\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" PR_Recv\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" probe_SSL_read_exit\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n11a:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]\n11b:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n11c:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"11d:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"for\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"size_t\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"0\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"strlen\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"hex_data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"32\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"11e:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"                \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"printf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"%.32s\\\\n\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" hex_data \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" i\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n11f:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]\n120:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"printf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"%s\\\\n\\\\n\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" e_mark\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n121:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"else\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}]\n122:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"printf\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\\n%s\\\\n%s\\\\n%s\\\\n\\\\n\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" s_mark\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" buf\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" e_mark\",[\"$\",\"span\",nu"])</script><script>self.__next_f.push([1,"ll,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]\n123:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]\n124:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]\n125:[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"23:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n1f:null\n"])</script><script>self.__next_f.push([1,"21:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"eBPF Practical Tutorial: Capturing SSL/TLS Plain Text Data Using uprobe | 云微的胡思乱想\"}],[\"$\",\"meta\",\"1\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"2\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"link\",\"3\",{\"rel\":\"canonical\",\"href\":\"https://www.yunwei37.com/blog/ssl-uprobe\"}],[\"$\",\"link\",\"4\",{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"https://www.yunwei37.com/feed.xml\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:title\",\"content\":\"eBPF Practical Tutorial: Capturing SSL/TLS Plain Text Data Using uprobe\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:url\",\"content\":\"https://www.yunwei37.com/blog/ssl-uprobe\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:site_name\",\"content\":\"云微的胡思乱想\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:image\",\"content\":\"https://www.yunwei37.com/static/images/twitter-card.png\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"11\",{\"property\":\"article:published_time\",\"content\":\"2023-06-14T02:41:06.000Z\"}],[\"$\",\"meta\",\"12\",{\"property\":\"article:modified_time\",\"content\":\"2023-06-14T02:41:06.000Z\"}],[\"$\",\"meta\",\"13\",{\"property\":\"article:author\",\"content\":\"Yusheng Zheng (云微)\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:title\",\"content\":\"eBPF Practical Tutorial: Capturing SSL/TLS Plain Text Data Using uprobe\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:image\",\"content\":\"https://www.yunwei37.com/static/images/twitter-card.png\"}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"26:\"$21:metadata\"\n"])</script></body></html>